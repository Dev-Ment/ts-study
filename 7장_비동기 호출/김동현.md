# 7ì¥ ë¹„ë™ê¸° í˜¸ì¶œ
ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ë‹¤ë£° ë•ŒëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì‚¬í•­ì„ ê³ ë ¤í•´ì•¼ í•œë‹¤.
- í˜„ì¬ ë¹„ë™ê¸°ëŠ” ì–´ë–¤ ìƒíƒœì¸ê°€?
- ë¹„ë™ê¸° ë™ì‘ì„ ìœ„í•´ í•„ìš”í•œ ì •ë³´ëŠ” ë¬´ì—‡ì¸ê°€?
- ìš”ì²­ì´ ì„±ê³µí–ˆë‹¤ë©´ ë°›ì•„ì˜¨ ì •ë³´ë¥¼ ì–´ë–»ê²Œ ì €ì¥í•˜ê³  ê´€ë¦¬í•  ê²ƒì¸ê°€?
- ìš”ì²­ì´ ì‹¤íŒ¨í–ˆë‹¤ë©´ ì‹¤íŒ¨ì— ëŒ€í•œ ì •ë³´ë¥¼ ì–´ë–»ê²Œ í™•ì¸í•  ê²ƒì¸ê°€?
- ë¹„ë™ê¸° ìš”ì²­ì— ëŒ€í•œ ì½”ë“œë¥¼ ì‰½ê²Œ ìœ ì§€ë³´ìˆ˜í•  ìˆ˜ ìˆë„ë¡ ì–´ë–»ê²Œ êµ¬ì¡°í™”í•˜ê³  ê´€ë¦¬í•  ê²ƒì¸ê°€?

## 7.1 API ìš”ì²­

### 7.1.1 fetchë¡œ API ìš”ì²­í•˜ê¸°
ì‹ ì… ê°œë°œìì¸ ê°œë°œì´ëŠ” ì‚¬ìš©ìê°€ ì¥ë°”êµ¬ë‹ˆë¥¼ ì¡°íšŒí•´ì„œ ë³¼ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ë§Œë“¤ê²Œ ë˜ì—ˆë‹¤. ê·¸ë˜ì„œ fetch í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ì™¸ë¶€ ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í–ˆë‹¤.
```typescript
import React, { useEffect, useState } from "react";

const CartBadge: React.FC = () => {
  const [cartCount, setCartCount] = useState(0);

  useEffect(() => {
    fetch("https://api.baemin.com/cart")
      .then((response) => response.json())
      .then(({ cartItem }) => {
        setCartCount(cartItem.length);
      });
  }, []);

  return <>{/*  cartCount ìƒíƒœë¥¼ ì´ìš©í•˜ì—¬ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ */}</>;
};
```

ì¥ë°”êµ¬ë‹ˆ ì •ë³´ë¥¼ ë¹„ë™ê¸° í•¨ìˆ˜ì¸ fetchë¡œ ë¶ˆëŸ¬ì™€ ì¥ë°”êµ¬ë‹ˆ ë‚´ë¶€ë¥¼ í™•ì¸í•˜ì—¬ ì¥ë°”êµ¬ë‹ˆì— ë‹´ê¸´ ë¬¼í’ˆì˜ ê°œìˆ˜ë¥¼ ë°°ì§€ ì•„ì´ì½˜ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” ê¸°ëŠ¥, ì‚¬ìš©ìì—ê²Œ ì¥ë°”êµ¬ë‹ˆì— ë‹´ì€ ë¬¼í’ˆì„ ë³´ì—¬ì£¼ëŠ” í˜ì´ì§€ êµ¬í˜„ ë“± ì—¬ëŸ¬ ê³³ì—ì„œ ê°™ì€ API URLì„ ë³µë¶™í•˜ì—¬ ì‚¬ìš©í–ˆë‹¤. 
í•˜ì§€ë§Œ ë§Œì•½ 'ì—¬ëŸ¬ ì„œë²„ì— APIë¥¼ ìš”ì²­í•  ë•Œ íƒ€ì„ì•„ì›ƒ ì„¤ì •ì´ í•„ìš”í•˜ë‹¤', 'ëª¨ë“  ìš”ì²­ì— ì»¤ìŠ¤í…€ í—¤ë”ê°€ í•„ìš”í•˜ë‹¤'ì™€ ê°™ì€ ìƒˆë¡œìš´ API ìš”ì²­ ì •ì±…ì´ ì¶”ê°€ë  ë•Œë§ˆë‹¤ ê³„ì†í•´ì„œ ë¹„ë™ê¸° í˜¸ì¶œ ì½”ë“œë¥¼ ìˆ˜ì •í•´ì•¼ í•˜ëŠ” ë²ˆê±°ë¡œì›€ì´ ë°œìƒí•œë‹¤.


### ì„œë¹„ìŠ¤ ë ˆì´ì–´ë¡œ ë¶„ë¦¬í•˜ê¸°
ì—¬ëŸ¬ API ìš”ì²­ ì •ì±…ì´ ì¶”ê°€ë˜ì–´ ì½”ë“œê°€ ë³€ê²½ë  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ê°ì•ˆí•œë‹¤ë©´, ë¹„ë™ê¸° í˜¸ì¶œ ì½”ë“œëŠ” ì»´í¬ë„ŒíŠ¸ ì˜ì—­ì—ì„œ ë¶„ë¦¬ë˜ì–´ ë‹¤ë¥¸ ì˜ì—­(ì„œë¹„ìŠ¤ ë ˆì–´ì–´)ì—ì„œ ì²˜ë¦¬ë˜ì–´ì•¼ í•œë‹¤.

ì•ìœ¼ ì½”ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì„¤ëª…í•˜ë©´ fetch í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ë¶€ë¶„ì´ ì„œë¹„ìŠ¤ ë ˆì´ì–´ë¡œ ì´ë™í•˜ê³ , ìº„í¬ë„ŒíŠ¸ëŠ” ì„œë¹„ìŠ¤ ë ˆì´ì–´ì˜ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ê·¸ ê²°ê³¼ë¥¼ ë°›ì•„ì™€ ë Œë”ë§í•˜ëŠ” íë¦„ì´ ëœë‹¤.

ê·¸ëŸ¬ë‚˜ ë‹¨ìˆœíˆ fetch í•¨ìˆ˜ë¥¼ ë¶„ë¦¬í•˜ëŠ” ê²ƒë§Œìœ¼ë¡œëŠ” API ìš”ì²­ ì •ì±…ì´ ì¶”ê°€ë˜ëŠ” ê²ƒì„ í•´ê²°í•˜ê¸° ì–´ë µê³ , ì¿¼ë¦¬ ë§¤ê°œë³€ìˆ˜ë‚˜ ì»¤ìŠ¤í…€ í—¤ë” ì¶”ê°€, ì¿ í‚¤ë¥¼ ì½ì–´ í† í°ì„ ì§‘ì–´ë„£ëŠ” ë“± ë‹¤ì–‘í•œ 
API ì •ì±…ì´ ì¶”ê°€ë  ìˆ˜ ìˆëŠ”ë° ì´ë¥¼ ëª¨ë‘ êµ¬í˜„í•˜ëŠ” ê²ƒì€ ë²ˆê±°ë¡œìš´ ì¼ì´ë‹¤.

```typescript
async function fetchCart() {
  const controller = new AbortController();
  //ë¸Œë¼ìš°ì €ì—ì„œ ì œê³µí•˜ëŠ” apië¡œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ì·¨ì†Œí•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤.
  //ìš”ì²­ì„ ì·¨ì†Œí•˜ë ¤ë©´ controller.abort()ë¥¼ í˜¸ì¶œí•œë‹¤.

  const timeoutId = setTimeout(() => controller.abort(), 5000);
  
  const response = await fetch("https://api.baemin.com/cart", {
    signal: controller.signal,
  });

  clearTimeout(timeoutId);

  return response;
}
```

### Axios í™œìš©í•˜ê¸°
fetchëŠ” ë‚´ì¥ ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ê¸° ë•Œë¬¸ì— ë”°ë¡œ importí•˜ê±°ë‚˜ ì„¤ì¹˜í•  í•„ìš” ì—†ì´ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤. ê·¸ëŸ¬ë‚˜ ë§ì€ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ë©´ ì§ì ‘ êµ¬í˜„í•´ì„œ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ë°, ì´ëŸ° ë²ˆê±°ëŸ¬ì›€ì„ ëœì–´ë‚´ê³ ì ëŒ€ì‹  Axios ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤.

```typescript
import axios, { AxiosInstance, AxiosPromise } from "axios";
// AxiosInstance : Axiosë¥¼ í†µí•´ ìƒì„±ëœ ì¸ìŠ¤í„´ìŠ¤ì˜ íƒ€ì…ì´ë‹¤.
// ì´ë¥¼ ì‚¬ìš©í•˜ë©´ ê¸°ë³¸ ì„¤ì •ì„ ê³µìœ í•˜ëŠ” Axios ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.

// AxiosPromise : Axiosê°€ ë°˜í™˜í•˜ëŠ” Promiseì˜ íƒ€ì…ì´ë‹¤.
// ì‘ë‹µ ë°ì´í„°ë¥¼ ì œë„¤ë¦­ íƒ€ì…ìœ¼ë¡œ ì§€ì •í•  ìˆ˜ ìˆë‹¤.

export type FetchCartResponse = unknown;
export type PostCartRequest = unknown;
export type PostCartResponse = unknown;
// ê° api ìš”ì²­/ì‘ë‹µ íƒ€ì…ì„ ì •ì˜í•œë‹¤.

export const apiRequester: AxiosInstance = axios.create({
  baseURL: "https://api.baemin.com", // ê¸°ë³¸ URL
  timeout: 5000, // 5ì´ˆë’¤ ì™„ë£Œë˜ì§€ ì•Šìœ¼ë©´ ìš”ì²­ ì¤‘ë‹¨
});
// axios.create({}): Axiosì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.

export const fetchCart = (): AxiosPromise<FetchCartResponse> =>
  apiRequester.get<FetchCartResponse>("cart");
// https://api.baemin.com/cartì— GETìš”ì²­

export const postCart = (
  postCartRequest: PostCartRequest
): AxiosPromise<PostCartResponse> =>
  apiRequester.post<PostCartResponse>("cart", postCartRequest);
// https://api.baemin.com/cartì— POSTìš”ì²­
// ìš”ì²­ ë³¸ë¬¸ìœ¼ë¡œ postCartRequestë¥¼ ì „ì†¡
```

ê° ì„œë²„(ì£¼ë¬¸ì„ ì²˜ë¦¬í•˜ëŠ” ì„œë²„ì™€ ì¥ë°”êµ¬ë‹ˆë¥¼ ì²˜ë¦¬í•˜ëŠ” ì„œë²„)ê°€ ë‹´ë‹¹í•˜ëŠ” ë¶€ë¶„ì´ ë‹¤ë¥´ê±°ë‚˜ ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ì˜ ì¼ë¶€ë¡œ í¬í•¨ë  ë•Œ ê¸°ì¡´ì— ì‚¬ìš©í•˜ëŠ” API Entry(Base URL)ì™€ëŠ” ë‹¤ë¥¸ ìƒˆë¡œìš´ URLë¡œ ìš”ì²­í•´ì•¼ í•˜ëŠ” ìƒí™©ì´ ìƒê¸¸ ìˆ˜ ìˆë‹¤.

API Entryê°€ 2ê°œ ì´ìƒì¼ ê²½ìš°ì— ê° ì„œë²„ì˜ ê¸°ë³¸ URLì„ í˜¸ì¶œí•˜ë„ë¡ `orderApiRequester`, `orderCartApiRequester`ê°™ì´ 2ê°œ ì´ìƒì˜ API ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë”°ë¡œ êµ¬ì„±í•´ì•¼ í•œë‹¤. ì´í›„ ë‹¤ë¥¸ URLë¡œ ì„œë¹„ìŠ¤ ì½”ë“œë¥¼ í˜¸ì¶œí•  ë•Œ ê°ê°ì˜ `apiRequester`ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

```typescript
import axios, { AxiosInstance } from "axios";

const defaultConfig = {};

const apiRequester: AxiosInstance = axios.create(defaultConfig);

const orderApiRequester: AxiosInstance = axios.create({
  baseURL: "https://api.baemin.or/",
  ...defaultConfig,
});
const orderCartApiRequester: AxiosInstance = axios.create({
  baseURL: "https://cart.baemin.order/",
  ...defaultConfig,
});

orderApiRequester.get("/order/12345");
// URL: https://api.baemin.or/order/12345

orderCartApiRequester.post("/cart", { itemId: 67890 });
// URL: https://cart.baemin.order/cart
```


### Axios ì¸í„°ì…‰í„° ì‚¬ìš©í•˜ê¸°
ê°ê°ì˜ `requester`ëŠ” ì„œë¡œ ë‹¤ë¥¸ ì—­í• ì„ ë‹´ë‹¹í•˜ëŠ” ë‹¤ë¥¸ ì„œë²„ì´ê¸° ë–„ë¬¸ì— `requester`ë³„ë¡œ ë‹¤ë¥¸ í—¤ë”ë¥¼ ì„¤ì •í•´ì¤˜ì•¼ í•˜ëŠ” ë¡œì§ì´ í•„ìš”í•  ìˆ˜ ìˆë‹¤.

ì´ë•Œ ì¸í„°ì…‰í„° ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ `requester`ì— ë”°ë¼ ë¹„ë™ê¸° í˜¸ì¶œ ë‚´ìš©ì„ ì¶”ê°€í•´ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆìœ¼ë©°, API ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•  ë•Œ í•˜ë‚˜ì˜ ì—ëŸ¬ ê°ì²´ë¡œ ë¬¶ì–´ ì²˜ë¦¬í•  ìˆ˜ë„ ìˆë‹¤.

```typescript
import axios, { AxiosInstance, AxiosRequestConfig, AxiosResponse } from "axios";

const getUserToken = () => "";
const getAgent = () => "";
const getOrderClientToken = () => "";
const orderApiBaseUrl = "";
const orderCartApiBaseUrl = "";
const defaultConfig = {};
const httpErrorHandler = () => {};

const apiRequester: AxiosInstance = axios.create({ // ê¸°ë³¸ APIìš”ì²­, ë…ë¦½ì ì¸ Axios ì¸ìŠ¤í„´ìŠ¤
  baseURL: "https://api.baemin.com",
  timeout: 5000,
});
// ê³µí†µ í—¤ë” ì„¤ì • í•¨ìˆ˜
const setRequestDefaultHeader = (requestConfig: AxiosRequestConfig) => {
  const config = requestConfig;
  config.headers = {
    ...config.headers,
    "Content-Type": "application/json;charset=utf-8",
    user: getUserToken(),
    agent: getAgent(),
  };
  return config;
};
// ì£¼ë¬¸ ì „ìš©? í—¤ë” ì„¤ì • í•¨ìˆ˜
const setOrderRequestDefaultHeader = (requestConfig: AxiosRequestConfig) => {
  const config = requestConfig;
  config.headers = {
    ...config.headers,
    "Content-Type": "application/json;charset=utf-8",
    "order-client": getOrderClientToken(),
  };
  return config;
};

// `interceptors` ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ headerë¥¼ ì„¤ì •í•˜ëŠ” ê¸°ëŠ¥ì„ ë„£ê±°ë‚˜ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤
apiRequester.interceptors.request.use(setRequestDefaultHeader); 
// ìš”ì²­ ì „ì— ì‹¤í–‰ë  ì¸í„°ì…‰í„° ì„¤ì • - ìš”ì²­ í—¤ë”ë¥¼ ì¶”ê°€ ë° ìˆ˜ì •
// ìš”ì²­ í›„ ì‹¤í–‰ë  ì¸í„°ì…‰í„° ìˆ˜ì • 

const orderApiRequester: AxiosInstance = axios.create({ // ë…ë¦½ì ì¸ Axios ì¸ìŠ¤í„´ìŠ¤
  baseURL: orderApiBaseUrl,
  ...defaultConfig,
});
// ê¸°ë³¸ apiRequesterì™€ëŠ” ë‹¤ë¥¸ headerë¥¼ ì„¤ì •í•˜ëŠ” `interceptors`
orderApiRequester.interceptors.request.use(setOrderRequestDefaultHeader);
// interceptors.request -> ì‘ë‹µ ì „
// interceptors.response -> ì‘ë‹µ í›„

// `interceptors`ë¥¼ ì‚¬ìš©í•´ httpError ê°™ì€ API ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ë„ ìˆë‹¤
orderApiRequester.interceptors.response.use(
  (response: AxiosResponse) => response, // ì •ìƒì´ë©´ ë°˜í™˜
  httpErrorHandler // ì—ëŸ¬ ë°œìƒ ì‹œ ì²˜ë¦¬
);

const orderCartApiRequester: AxiosInstance = axios.create({ // ë…ë¦½ì ì¸ Axios ì¸ìŠ¤í„´ìŠ¤
  baseURL: orderCartApiBaseUrl,
  ...defaultConfig,
});
orderCartApiRequester.interceptors.request.use(setRequestDefaultHeader);
```

ìš”ì²­ ì˜µì…˜ì— ë”°ë¼ ë‹¤ë¥¸ ì¸í„°ì…‰í„°ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ **ë¹Œë”íŒ¨í„´**ì„ ì¶”ê°€í•˜ì—¬ `APIBuilder`ê°™ì€ í´ë˜ìŠ¤ í˜•íƒœë¡œ êµ¬ì„±í•˜ê¸°ë„ í•œë‹¤.


ğŸ“¢ ë¹Œë” íŒ¨í„´(Builder Pattern)
ê°ì²´ ìƒì„±ì„ ë” í¸ë¦¬í•˜ê³  ê°€ë…ì„± ìˆê²Œ ë§Œë“¤ê¸° ìœ„í•œ ë””ìì¸ íŒ¨í„´ ì¤‘ í•˜ë‚˜ë‹¤. ì£¼ë¡œ ë³µì¡í•œ ê°ì²´ì˜ ìƒì„±ì„ ë‹¨ìˆœí™”í•˜ê³ , ê°ì²´ ìƒì„± ê³¼ì •ì„ ë¶„ë¦¬í•˜ì—¬ ê°ì²´ë¥¼ ì¡°ë¦½í•˜ëŠ” ë°©ë²•ì„ ì œê³µí•œë‹¤.

```typescript
import axios, { AxiosPromise } from "axios";

// ì„ì‹œ íƒ€ì´í•‘
export type HTTPMethod = "GET" | "POST" | "PUT" | "DELETE";

export type HTTPHeaders = any;

export type HTTPParams = unknown;

//
class API {
  readonly method: HTTPMethod;

  readonly url: string;

  baseURL?: string;

  headers?: HTTPHeaders;

  params?: HTTPParams;

  data?: unknown;

  timeout?: number;

  withCredentials?: boolean;

  constructor(method: HTTPMethod, url: string) {
    this.method = method;
    this.url = url;
  }

  call<T>(): AxiosPromise<T> {
    const http = axios.create();
    // ë§Œì•½ `withCredential`ì´ ì„¤ì •ëœ APIë¼ë©´ ì•„ë˜ ê°™ì´ ì¸í„°ì…‰í„°ë¥¼ ì¶”ê°€í•˜ê³ , ì•„ë‹ˆë¼ë©´ ì¸í„°ì…‰í„° ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
    if (this.withCredentials) {
      http.interceptors.response.use(
        (response) => response,
        (error) => {
          if (error.response && error.response.status === 401) {
            /* ì—ëŸ¬ ì²˜ë¦¬ ì§„í–‰ */
          }
          return Promise.reject(error);
        }
      );
    }
    return http.request({ ...this });
  }
}

export default API;
```
ì´ì²˜ëŸ¼ ê¸°ë³¸ API í´ë˜ìŠ¤ë¡œ ì‹¤ì œ í˜¸ì¶œ ë¶€ë¶„ì„ êµ¬ì„±í•˜ê³ , ìœ„ì™€ ê°™ì€ APIë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•œ ë˜í¼ë¥¼ ë¹Œë” íŒ¨í„´ìœ¼ë¡œ ë§Œë“ ë‹¤.

```typescript
const apiHost = "";

class APIBuilder {
  private _instance: API;

  constructor(method: HTTPMethod, url: string, data?: unknown) {
    this._instance = new API(method, url);
    this._instance.baseURL = apiHost;
    this._instance.data = data;
    this._instance.headers = {
      "Content-Type": "application/json; charset=utf-8",
    };
    this._instance.timeout = 5000;
    this._instance.withCredentials = false;
  }

  // http ë©”ì„œë“œì— ë”°ë¼ APIBuilder ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ë©”ì„œë“œë“¤
  static get = (url: string) => new APIBuilder("GET", url);

  static put = (url: string, data: unknown) => new APIBuilder("PUT", url, data);

  static post = (url: string, data: unknown) => new APIBuilder("POST", url, data);

  static delete = (url: string) => new APIBuilder("DELETE", url);

  baseURL(value: string): APIBuilder {
    this._instance.baseURL = value;
    return this;
  }

  headers(value: HTTPHeaders): APIBuilder {
    this._instance.headers = value;
    return this;
  }

  timeout(value: number): APIBuilder {
    this._instance.timeout = value;
    return this;
  }

  params(value: HTTPParams): APIBuilder {
    this._instance.params = value;
    return this;
  }

  data(value: unknown): APIBuilder {
    this._instance.data = value;
    return this;
  }

  withCredentials(value: boolean): APIBuilder {
    this._instance.withCredentials = value;
    return this;
  }

  // êµ¬ì„±ëœ API ê°ì²´ë¥¼ ë°˜í™˜.
  build(): API {
    return this._instance;
  }
}

export default APIBuilder;
```
ì´ì™€ ê°™ì€ íŒ¨í„´ì¸ APIBuilderë¥¼ ì‚¬ìš©í•˜ëŠ” ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```typescript
import APIBuilder from "./7.1.4-3";

// ex
type Response<T> = { data: T };
type JobNameListResponse = string[];

const fetchJobNameList = async (name?: string, size?: number) => {
  const api = APIBuilder.get("/apis/web/jobs")
    .withCredentials(true) // ì´ì œ 401 ì—ëŸ¬ê°€ ë‚˜ëŠ” ê²½ìš°, ìë™ìœ¼ë¡œ ì—ëŸ¬ë¥¼ íƒì§€í•˜ëŠ” ì¸í„°ì…‰í„°ë¥¼ ì‚¬ìš©í•˜ê²Œ ëœë‹¤
    .params({ name, size }) // bodyê°€ ì—†ëŠ” axios ê°ì²´ë„ ë¹Œë” íŒ¨í„´ìœ¼ë¡œ ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤
    .build();
  const { data } = await api.call<Response<JobNameListResponse>>();
  return data;
};
```

APIBuilder í´ë˜ìŠ¤ëŠ” **ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸** ì½”ë“œê°€ ë§ë‹¤ëŠ” ë‹¨ì ì„ ê°–ê³  ìˆë‹¤. í•˜ì§€ë§Œ ì˜µì…˜ì´ ë‹¤ì–‘í•œ ê²½ìš°ì— ì¸í„°ì…‰í„°ë¥¼ ì„¤ì •ê°’ì— ë”°ë¼ ì ìš©í•˜ê³ , í•„ìš” ì—†ëŠ” ì¸í„°ì…‰í„°ë¥¼ ì„ íƒì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ë„ ê°€ì§€ê³  ìˆë‹¤.


ğŸ“¢ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸(Boilerplate) ì½”ë“œ
ì–´ë–¤ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ë•Œ ë°˜ë³µì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ê¸°ë³¸ì ì¸ ì½”ë“œë¥¼ ë§í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ APIë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•œ ê¸°ë³¸ì ì¸ ì„¤ì •ê³¼ ì¸í„°ì…‰í„° ë“±ì„ ì„¤ì •í•˜ëŠ” ë¶€ë¶„ì„ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ì½”ë“œë¡œ ê°„ì£¼í•  ìˆ˜ ìˆë‹¤.


### API ì‘ë‹µ íƒ€ì… ì§€ì •í•˜ê¸°

ê°™ì€ ì„œë²„ì—ì„œ ì˜¤ëŠ” ì‘ë‹µì˜ í˜•íƒœëŠ” ëŒ€ì²´ë¡œ í†µì¼ë˜ì–´ ìˆì–´ì„œ ì•ì„œ ì†Œê°œí•œ APIì˜ ì‘ë‹µ ê°’ì€ í•˜ë‚˜ì˜ Response íƒ€ì…ìœ¼ë¡œ ë¬¶ì¼ ìˆ˜ ìˆë‹¤.

```typescript
type FetchCartResponse = unknown;
type PostCartRequest = unknown;
type PostCartResponse = unknown;

export interface Response<T> {
  data: T;
  status: string;
  serverDateTime: string;
  errorCode?: string; // FAIL, ERROR errorMessage?: string; // FAIL, ERROR
}
const fetchCart = (): AxiosPromise<Response<FetchCartResponse>> =>
  apiRequester.get<Response<FetchCartResponse>>("cart");

const postCart = (
  postCartRequest: PostCartRequest
): AxiosPromise<Response<PostCartResponse>> =>
  apiRequester.post<Response<PostCartResponse>>("cart", postCartRequest);
```

ì„œë²„ì—ì„œ ì˜¤ëŠ” ì‘ë‹µì„ í†µì¼í•´ì¤„ ë•Œ ì£¼ì˜í•  ì ì€ Response íƒ€ì…ì„ apiRequester ë‚´ì—ì„œ ì²˜ë¦¬í•˜ë ¤ê³  í•  ìˆ˜ ìˆëŠ”ë° ì´ë ‡ê²Œ í•˜ë©´ UPDATEë‚˜ CREATEì™€ ê°™ì´ ì‘ë‹µì´ ì—†ì„ ìˆ˜ ìˆëŠ” APIë¥¼ ì²˜ë¦¬í•˜ê¸° ê¹Œë‹¤ë¡œì›Œì§„ë‹¤.

```typescript
const updateCart = (
  updateCartRequest: unknown
): AxiosPromise<Response<FetchCartResponse>> => apiRequester.get("cart");
// updateCart í•¨ìˆ˜ëŠ” í•­ìƒ íŠ¹ì •í•œ <Response<FetchCartResponse> íƒ€ì…ìœ¼ë¡œ ì‘ë‹µì„ ì²˜ë¦¬í•œë‹¤.
```
ë”°ë¼ì„œ Response íƒ€ì…ì€ apiRequesterê°€ ëª¨ë¥´ê²Œ ê´€ë¦¬ë˜ì–´ì•¼ í•œë‹¤. 

í•´ë‹¹ ê°’ì— ì–´ë–¤ ì‘ë‹µì´ ë“¤ì–´ìˆëŠ”ì§€ ì•Œ ìˆ˜ ì—†ê±°ë‚˜ ê°’ì˜ í˜•ì‹ì´ ë‹¬ë¼ì§€ë”ë¼ë„ ë¡œì§ì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ” ê²½ìš°ì—ëŠ” unknowníƒ€ì…ì„ ì‚¬ìš©í•˜ì—¬ ì•Œ ìˆ˜ ì—†ëŠ” ê°’ì„ì„ í‘œí˜„í•œë‹¤.
```typescript
interface response {
  data: {
    cartItems: CartItem[];
    forPass: unknown;
  };
}
```
ë§Œì•½ forPass ì•ˆì— í”„ë¡ íŠ¸ ë¡œì§ì—ì„œ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê°’ì´ ìˆë‹¤ë©´, ì—¬ì „íˆ ì–´ë–¤ ê°’ì´ ë“¤ì–´ì˜¬ì§€ ëª¨ë¥´ê¸° ë•Œë¬¸ì— unknownì„ ìœ ì§€í•œë‹¤. ë¡œê·¸ë¥¼ ë‚¨ê¸°ê±°ë‚˜, ë°±ì—”ë“œë¡œ ë‹¨ìˆœíˆ ì „ë‹¬í•˜ëŠ” ê²½ìš°ë¼ë©´ ê°’ì˜ íƒ€ì…ì€ ì–¸ì œë“ ì§€ ë³€ê²½ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ forPass ë‚´ì˜ ê°’ì„ ì‚¬ìš©í•˜ì§€ ì•Šì•„ì•¼ í•œë‹¤. ë‹¤ë§Œ, ì´ë¯¸ ì„¤ê³„ëœ í”„ë¡œë•íŠ¸ì—ì„œ ì“°ê³  ì‡ëŠ” ê°’ì´ë¼ë©´ í”„ë¡ íŠ¸ ë¡œì§ì—ì„œ ì¨ì•¼ í•˜ëŠ” ê°’ì— ëŒ€í•´ì„œë§Œ íƒ€ì…ì„ ì„ ì–¸í•œ ë‹¤ìŒì— ì‚¬ìš©í•˜ëŠ” ê²Œ ì¢‹ë‹¤.

```typescript
type ForPass = {
  type: "A" | "B" | "C";
};

const isTargetValue = () => (data.forPass as ForPass).type === "A";
```

### ë·° ëª¨ë¸(View Model) ì‚¬ìš©í•˜ê¸°

API ì‘ë‹µì€ ë³€í•  ê°€ëŠ¥ì„±ì´ í¬ë‹¤. íŠ¹íˆ ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ëŠ” ì„œë²„ ìŠ¤í™ì´ ìì£¼ ë°”ë€Œê¸° ë•Œë¬¸ì— ë·° ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ API ë³€ê²½ì— ë”°ë¥¸ ë²”ìœ„ë¥¼ í•œì •í•´ì¤˜ì•¼ í•œë‹¤.

```typescript
interface ListResponse {
  items: ListItem[];
}

const fetchList = async (filter?: ListFetchFilter): Promise<ListResponse> => {
  const { data } = await api
    .params({ ...filter })
    .get("/apis/get-list-summaries")
    .call<Response<ListResponse>>();

  return { data };
};
```
í•´ë‹¹ APIë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” ë‹¤ìŒì²˜ëŸ¼ ì‚¬ìš©í•œë‹¤. 

```typescript
const ListPage: React.FC = () => {
  const [totalItemCount, setTotalItemCount] = useState(0);
  const [items, setItems] = useState<ListItem[]>([]);

  useEffect(() => {
    // ì˜ˆì‹œë¥¼ ìœ„í•œ API í˜¸ì¶œê³¼ then êµ¬ë¬¸
    fetchList(filter).then(({ items }) => {
      setTotalItemCount(items.length);
      setItems(items);
    });
  }, []);

  return (
    <div>
      <Chip label={totalItemCount} />
      <Table items={items} />
    </div>
  );
};
```
í”íˆ ì¢‹ì€ ì»´í¬ë„ŒíŠ¸ëŠ” ë³€ê²½ë  ì´ìœ ê°€ í•˜ë‚˜ë¿ì¸ ì»´í¬ë„ŒíŠ¸ë¼ê³  ë§í•œë‹¤. API ì‘ë‹µì˜ items ì¸ìë¥¼ ì¢€ ë” ì •í™•í•œ ê°œë…ìœ¼ë¡œ ë‚˜íƒ€ë‚´ê¸° ìœ„í•´ `jobItems`ë‚˜ `cartItems` ê°™ì€ ì´ë¦„ìœ¼ë¡œ ìˆ˜ì •í•˜ë©´ í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ë„ ìˆ˜ì •í•´ì•¼ í•œë‹¤. ì´ë ‡ê²Œ ìˆ˜ì •í•´ì•¼í•  ì»´í¬ë„ŒíŠ¸ê°€ API 1ê°œì— í•˜ë‚˜ë¼ë©´ ì¢‹ê² ì§€ë§Œ, APIë¥¼ ì‚¬ìš©í•˜ëŠ” ê¸°ì¡´ ì»´í¬ë„ŒíŠ¸ë„ ìˆ˜ì •ë˜ì–´ì•¼ í•œë‹¤.

ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë°©ë²•ìœ¼ë¡œ ë·° ëª¨ë¸ì„ ë„ì…í•  ìˆ˜ ìˆë‹¤.

```typescript
interface JobListItemResponse {
  name: string;
}

interface JobListResponse {
  jobItems: JobListItemResponse[];
}

class JobList {
  readonly totalItemCount: number;
  readonly items: JobListItemResponse[];

  constructor({ jobItems }: JobListResponse) {
    this.totalItemCount = jobItems.length;
    this.items = jobItems;
  }
}

const fetchJobList = async (
  filter?: ListFetchFilter
): Promise<JobListResponse> => {
  const { data } = await api
    .params({ ...filter })
    .get("/apis/get-list-summaries")
    .call<Response<JobListResponse>>();

  return new JobList(data); // ì‘ë‹µ ë°ì´í„°ë¥¼ ë·° ëª¨ë¸ë¡œ ë³€í™˜í•˜ì—¬ ë°˜í™˜
};
```
ë·° ëª¨ë¸ì„ ë§Œë“¤ë©´ API ì‘ë‹µì´ ë°”ë€Œì–´ë„ UIê°€ ê¹¨ì§€ì§€ ì•Šê²Œ ê°œë°œí•  ìˆ˜ ìˆë‹¤. ë˜í•œ ì•ì˜ ì˜ˆì‹œì²˜ëŸ¼ API ì‘ë‹µì—ëŠ” ì—†ëŠ” `totalItemCount`ê°™ì€ ë„ë©”ì¸ ê°œë…ì„ ë„£ì„ ë•Œ ë°±ì—”ë“œë‚˜ UIì—ì„œ ë¡œì§ì„ ì¶”ê°€í•˜ì—¬ ì²˜ë¦¬í•  í•„ìš” ì—†ì´ ê°„í¸í•˜ê²Œ ìƒˆë¡œìš´ í•„ë“œë¥¼ ë·° ëª¨ë¸ì— ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.

ê·¸ëŸ¬ë‚˜ ë·° ëª¨ë¸ ë°©ì‹ì—ì„œë„ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ì¶”ìƒí™” ë ˆì´ì–´ ì¶”ê°€ëŠ” ê²°êµ­ ì½”ë“œë¥¼ ë³µì¡í•˜ê²Œ ë§Œë“¤ë©° ë ˆì´ì–´ë¥¼ ê´€ë¦¬í•˜ê³  ê°œë°œí•˜ëŠ” ë°ë„ ë¹„ìš©ì´ ë“ ë‹¤. ì•ì˜ ì½”ë“œì—ì„œ `JobListItemResponse` íƒ€ì…ì€ ì„œë²„ì—ì„œ ì§€ì •í•œ ì‘ë‹µ í˜•ì‹ì´ê¸° ë•Œë¬¸ì— ì´ë¥¼ UIì—ì„œ ì‚¬ìš©í•˜ë ¤ë©´ ë‹¤ìŒì²˜ëŸ¼ ë§ì€ íƒ€ì„ì„ ì„ ì–¸í•´ì•¼ í•œë‹¤.

```typescript
interface JobListResponse {
  jobItems: JobListItemResponse[];
}

class JobListItem {
  constructor(item: JobListItemResponse) {
    // JobListItemResponseì—ì„œ JobListItem ê°ì²´ë¡œ ë³€í™˜í•´ì£¼ëŠ” ì½”ë“œ
  }
}

class JobList {
  readonly totalItemCount: number;
  readonly items: JobListItemResponse[];
  constructor({ jobItems }: JobListResponse) {
    this.totalItemCount = jobItems.length;
    this.items = jobItems.map((item) => new JobListItem(item));
  }
}

const fetchJobList = async (
  filter?: ListFetchFilter
): Promise<JobListResponse> => {
  const { data } = await api
    .params({ ...filter })
    .get("/apis/get-list-summaries")
    .call<Response<JobListResponse>>();

  return new JobList(data);
};
```
ë‹¨ìˆœíˆ API 20ê°œë¥¼ ì¶”ê°€í•œë‹¤ë©´ 20ê°œì˜ ì‘ë‹µì´ ì¶”ê°€ë  ê²ƒì´ë‹¤. ì´ ë§ì€ 20ê°œ ì´ìƒ ë·° ëª¨ë¸ì´ ì¶”ê°€ë  ìˆ˜ ìˆë‹¤ëŠ” ëœ»ì´ë‹¤. ì• ì½”ë“œì˜ `totalItemCount`ê°™ì´ API ì‘ë‹µì—ëŠ” ì—†ëŠ” ìƒˆë¡œìš´ í•„ë“œë¥¼ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•  ë•Œ, ì„œë²„ê°€ ë‚´ë ¤ì¤€ ì‘ë‹µê³¼ í´ë¼ì´ì–¸íŠ¸ê°€ ì‹¤ì œ ì‚¬ìš©í•˜ëŠ” ë„ë©”ì¸ì´ ë‹¤ë¥´ë‹¤ë©´ ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ ê°„ì˜ ì˜ì‚¬ì†Œí†µ ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤.

ë”°ë¼ì„œ, APIì‘ë‹µì´ ë°”ë€Œì—ˆì„ ë•ŒëŠ” í´ë¼ì´ì–¸íŠ¸ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ëŠ” ë° ë“¤ì–´ê°€ëŠ” ë¹„ìš©ì„ ì¤„ì´ë©´ì„œë„ ë„ë©”ì¸ì˜ ì¼ê´€ì„±ì„ ì§€í‚¬ ìˆ˜ ìˆëŠ” ì ˆì¶©ì•ˆì„ ì°¾ì•„ì•¼í•œë‹¤.

ì˜ˆì‹œ
- ê¼­ í•„ìš”í•œ ê³³ì—ë§Œ ë·° ëª¨ë¸ì„ ë¶€ë¶„ì ìœ¼ë¡œ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•˜ê¸°
- ë°±ì—”ë“œì™€ í´ë¼ì´ì–¸íŠ¸ ê°œë°œìê°€ ì¶©ë¶„íˆ ì†Œí†µí•œ ë‹¤ìŒ ê°œë°œí•˜ì—¬ API ì‘ë‹µ ë³€í™”ë¥¼ ìµœëŒ€í•œ ì¤„ì´ê¸°
- ë·° ëª¨ë¸ì— í•„ë“œë¥¼ ì¶”ê°€í•˜ëŠ” ëŒ€ì‹  getter ë“±ì˜ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•˜ì—¬ ì‹¤ì œ ì–´ë–¤ ê°’ì´ ë·° ëª¨ë¸ì— ì¶”ê°€í•œ ê°’ì¸ì§€ ì•Œê¸° ì‰½ê²Œ í•˜ê¸°

ê°œë°œ ë‹¨ê³„ì—ì„œëŠ” API ì‘ë‹µ í˜•ì‹ì´ ìì£¼ ë°”ë€ë‹¤. ë˜í•œ ì‘ë‹µ ê°’ì˜ íƒ•ë¹„ì´ stringì´ì–´ì•¼í•˜ëŠ” ë° numberê°€ ë“¤ì–´ì˜¤ëŠ” ê²ƒê³¼ ê°™ì´ ì˜ëª»ëœ íƒ€ì…ì´ ì „ë‹¬ë˜ê¸°ë„ í•œë‹¤. ê·¸ëŸ¬ë‚˜ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ëŠ” ì •ì  ê²€ì‚¬ ë„êµ¬ë¡œ ëŸ°íƒ€ì„ì— ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ë¥¼ ì°¾ì•„ë‚¼ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ëŸ°íƒ€ì„ì— API ì‘ë‹µì˜ íƒ€ì…ì˜¤ë¥˜ë¥¼ ë°©ì§€í•˜ë ¤ë©´ Superstruct ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

### Superstructë¥¼ ì‚¬ìš©í•´ ëŸ°íƒ€ì„ì—ì„œ ì‘ë‹µ íƒ€ì… ê²€ì¦í•˜ê¸°
ëŸ°íƒ€ì„ ì‘ë‹µ íƒ€ì… ê²€ì¦ì„ í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” Superstruct ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ì†Œê°œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.
- Superstructë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸í„°í˜ì´ìŠ¤ ì •ì˜ì™€ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë°ì´í„°ì˜ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ì‰½ê²Œ í•  ìˆ˜ ìˆë‹¤.
- SuperstructëŠ” ëŸ°íƒ€ì„ì—ì„œì˜ ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í†µí•´ ê°œë°œìì™€ ì‚¬ìš©ìì—ê²Œ ìì„¸í•œ ëŸ°íƒ€ì„ ì—ëŸ¬ë¥¼ ë³´ì—¬ì£¼ê¸° ìœ„í•´ ê³ ì•ˆë˜ì—ˆë‹¤.

Superstructì˜ ì‚¬ìš© ë°©ë²•

```typescript
import {
  assert,
  is,
  validate,
  object,
  number,
  string,
  array,
} from "superstruct";

const Article = object({ // ê°ì²´í˜•íƒœ
  id: number(), // number íƒ€ì…
  title: string(), // string íƒ€ì…
  tags: array(string()), // ë¬¸ìì—´ ë°°ì—´
  author: object({
    id: number(), // idë¼ëŠ” ì†ì„±ì„ ê°€ì§„ ê°ì²´
  }),
});

const data = {
  id: 34,
  title: "Hello World",
  tags: ["news", "features"],
  author: {
    id: 1,
  },
};

assert(data, Article);
is(data, Article);
validate(data, Article);

```
ë¨¼ì € `Article`ì´ë¼ëŠ” ë³€ìˆ˜ëŠ” Superstructì˜ `object()` ëª¨ë“ˆì˜ ë°˜í™˜ ê²°ê³¼ì´ë‹¤. object()ë¼ëŠ” ëª¨ë“ˆ ì´ë¦„ì—ì„œ ì˜ˆìƒí•  ìˆ˜ ìˆë“¯ì´ `Article`ì€ `object`í˜•íƒœë¥¼ ê°€ì§„ ë¬´ì—‡ê°€ë¼ê³  ìƒê°í•  ìˆ˜ ìˆë‹¤.

ê·¸ë ‡ë‹¤ë©´ number(), string() ëª¨ë“ˆì˜ ë°˜í™˜ íƒ€ì…ë„ ìˆ«ì, ë¬¸ìì—´ í˜•íƒœë¼ê³  ì´í•´í•  ìˆ˜ ìˆë‹¤.

`assert`, `i`s, `validate`ëŠ” ê°ê° 'í™•ì¸', '~ì´ë‹¤, 'ê²€ì‚¬í•˜ë‹¤' ì •ë„ë¡œ ì§ì—­í•  ìˆ˜ ìˆëŠ”ë° 3ê°€ì§€ ëª¨ë‘ ë°ì´í„°ì˜ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ë„ì™€ì£¼ëŠ” ëª¨ë¸ì´ë‹¤.

ì„¸ ëª¨ë“ˆì˜ ê³µí†µì ì€ ë°ì´í„° ì •ë³´ë¥¼ ë‹´ì€ data ë³€ìˆ˜ì™€ ë°ì´í„° ëª…ì„¸ë¥¼ ê°€ì§„ ìŠ¤í‚¤ë§ˆì¸ Articleì„ ì¸ìë¡œ ë°›ì•„ ë°ì´í„°ê°€ ìŠ¤í‚¤ë§ˆì™€ ë¶€í•©í•˜ëŠ”ì§€ë¥¼ ê²€ì‚¬í•œë‹¤ëŠ” ê²ƒì¸ë° ì°¨ì´ì ì€ ëª¨ë“ˆë§ˆë‹¤ ë°ì´í„°ì˜ ìœ íš¨ì„±ì„ ë‹¤ë¥´ê²Œ ì ‘ê·¼í•˜ê³  ë°˜í™˜ ê°’ì˜ í˜•íƒœê°€ ë‹¤ë¥´ë‹¤.

- `assert`ëŠ” ìœ íš¨í•˜ì§€ ì•Šì„ ê²½ìš° ì—ëŸ¬ë¥¼ ë˜ì§„ë‹¤.
- `is`ëŠ” ìœ íš¨ì„± ê²€ì‚¬ ê²°ê³¼ì— ë”°ë¼ `true`ë˜ëŠ” `false`ë¥¼ ë°˜í™˜í•œë‹¤.
- `validate`ëŠ” `[error, data]` í˜•ì‹ì˜ íŠœí”Œì„ ë°˜í™˜í•œë‹¤. ìœ íš¨í•˜ì§€ ì•Šì„ ë•ŒëŠ” ì—ëŸ¬ ê°’ì´ ë°˜í™˜ë˜ê³  ìœ íš¨í•œ ê²½ìš°ì—ëŠ” ì²« ë²ˆì§¸ ìš”ì†Œë¡œ `undefined`, ë‘ ë²ˆì§¸ ìš”ì†Œë¡œ `data value`ê°€ ë°˜í™˜ëœë‹¤.



íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì™€ ì–´ë–¤ ì‹œë„ˆì§€ë¥¼ ë°œíœ˜í•˜ëŠ”ì§€ ì•Œì•„ë³´ì.

ë¨¼ì € ì•„ë˜ì™€ ê°™ì´ `Infer`ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ì¡´ íƒ€ì… ì„ ì–¸ ë°©ì‹ê³¼ ë™ì¼í•˜ê²Œ íƒ€ì…ì„ ì„ ì–¸í•  ìˆ˜ ìˆë‹¤.

```typescript
import { Infer, number, object, string } from "superstruct";

const User = object({
  id: number(),
  email: string(),
  name: string(),
});

type User = Infer<typeof User>; // ê¸°ì¡´ì˜ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²•
```

Superstructì˜ `assert` ë©”ì„œë“œë¥¼ í†µí•´ ì¸ìë¡œ ë°›ëŠ” `user`ê°€ `User` íƒ€ì…ê³¼ ë§¤ì¹­ë˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” `isUser` í•¨ìˆ˜ì´ë‹¤.

```typescript
type User = { id: number; email: string; name: string };

import { assert } from "superstruct";

function isUser(user: User) {
  assert(user, User);
  console.log("ì ì ˆí•œ ìœ ì €ì…ë‹ˆë‹¤.");
}

const user_A = {
  id: 4,
  email: "test@woowahan.email",
  name: "woowa",
};

isUser(user_A); // ì ì ˆí•œ ìœ ì €ì…ë‹ˆë‹¤.
```

ê¸°ëŒ€í•˜ë˜ ë°ì´í„° í˜•ì‹ê³¼ ë‹¬ë¦¬ ëŸ°íƒ€ì„ì— ë°ì´í„°ê°€ ì˜¤ì—¼ë˜ì–´ ë“¤ì–´ì™”ì„ ë•ŒëŠ” ì•„ë˜ì™€ ê°™ì´ ëœë‹¤.

```tpyescript
const user_B = {
  id: 5,
  email: "wrong@woowahan.email",
  name: 4,
};

isUser(user_B); // error TS2345: Argument of type '{ id: number; email: string; name: number; }' is not assignable to parameter of type '{ id: number; email: string; name: string; }'
```

ì´ì²˜ëŸ¼ ì»´íŒŒì¼ ë‹¨ê³„ê°€ ì•„ë‹Œ ëŸ°íƒ€ì„ì—ì„œë„ ì ì ˆí•œ ë°ì´í„°ì¸ì§€ë¥¼ í™•ì¸í•˜ëŠ” ê²€ì‚¬ê°€ í•„ìš”í•  ë•Œ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.


### ì‹¤ì œ API ì‘ë‹µ ì‹œì˜ Superstruct í™œìš© ì‚¬ë¡€
Superstructì´ API ì‘ë‹µ ì‹œ í™œìš©ë˜ëŠ” ë°©ë²•ì„ ì˜ˆì‹œë¡œ ì•Œì•„ë³´ì.

`fetchList`ì˜ í˜¸ì¶œ ê²°ê³¼ëŠ” `ListItem` íƒ€ì…ì˜ ë°°ì—´ì´ë‹¤. ì—¬ê¸°ì—ì„œëŠ” `ListItem` íƒ€ì…ì´ ë‹¤ìŒê°€ ê°™ë‹¤ê³  ê°€ì •í•´ë³´ì.

```tpyescript
interface ListItem {
  id: string;
  content: string;
}

interface ListResponse {
  items: ListItem[];
}
const fetchList = async (filter?: ListFetchFilter): Promise<ListResponse> => {
  const { data } = await api
    .params({ ...filter })
    .get("/apis/get-list-summaries")
    .call<Response<ListResponse>>();

  return { data };
};
```

ìš°ë¦¬ëŠ” `fetchList` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí–ˆì„ ë•Œ `id`ì™€ `content`ê°€ ë‹´ê¸´ `ListItem` íƒ€ì…ì˜ ë°°ì—´ì´ ì˜¤ê¸°ë¥¼ ê¸°ëŒ€í•œë‹¤. í•˜ì§€ë§Œ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ëŠ” ì»´íŒŒì¼ íƒ€ì„ì— íƒ€ì…ì„ ê²€ì¦í•˜ëŠ” ì—­í• ì„ í•˜ê¸° ë•Œë¬¸ì— íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë§Œìœ¼ë¡œëŠ” ì‹¤ì œ ì„œë²„ ì‘ë‹µì˜ í˜•ì‹ê³¼ ëª…ì‹œí•œ íƒ€ì…ì´ ì¼ì¹˜í•˜ëŠ”ì§€ë¥¼ í™•ì¸í•  ìˆ˜ ì—†ë‹¤.

ì´ë•Œ Superstructë¥¼ í™œìš©í•˜ì—¬ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¡œ ì„ ì–¸í•œ íƒ€ì…ê³¼ ì‹¤ì œ ëŸ°íƒ€ì„ì—ì„œì˜ ë°ì´í„° ì‘ë‹µ ê°’ì„ ë§¤ì¹­í•˜ì—¬ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•  ìˆ˜ ìˆë‹¤.

```typescript
import { assert } from "superstruct";

function isListItem(listItems: ListItem[]) {
  listItems.forEach((listItem) => assert(listItem, ListItem));
}
```
`isListItem`ì€ `ListItem`ì˜ ë°°ì—´ ëª©ë¡ì„ ë°›ì•„ì™€ ë°ì´í„°ê°€ ListItem íƒ€ì…ê³¼ ë™ì¼í•œì§€ í™•ì¸í•˜ê³  ë‹¤ë¥¼ ê²½ìš°ì—ëŠ” ì—ëŸ¬ë¥¼ ë˜ì§„ë‹¤.



## API ìƒíƒœ ê´€ë¦¬í•˜ê¸°

### ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ í˜¸ì¶œí•˜ê¸°
ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ë¹„ë™ê¸° í•¨ìˆ˜ë“¤ì€ ì„œë¹„ìŠ¤ì½”ë“œë¥¼ ì‚¬ìš©í•´ì„œ ë¹„ë™ê¸° ìƒíƒœë¥¼ ë³€í™”ì‹œí‚¬ ìˆ˜ ìˆëŠ” í•¨ìˆ˜ë¥¼ ì œê³µí•œë‹¤. ì»´í¬ë„ŒíŠ¸ëŠ” ì´ëŸ¬í•œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒíƒœë¥¼ êµ¬ë…í•˜ë©°, ìƒíƒœê°€ ë³€ê²½ë  ë•Œ ì»´í¬ë„ŒíŠ¸ë¥¼ ë‹¤ì‹œ ë Œë”ë§í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë™ì‘í•œë‹¤.

ReduxëŠ” ë¹„êµì  ì´ˆê¸°ì— ë‚˜ì˜¨ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë‹¤.

```typescript
import { useEffect } from "react";
import { useDispatch, useSelector } from "react-redux";

export function useMonitoringHistory() {
  const dispatch = useDispatch();

  // ì „ì—­ Store ìƒíƒœ(RootState)ì—ì„œ í•„ìš”í•œ ë°ì´í„°ë§Œ ê°€ì ¸ì˜¨ë‹¤
  const searchState = useSelector(
    (state: RootState) => state.monitoringHistory.searchState
  );

  // history ë‚´ì—­ì„ ê²€ìƒ‰í•˜ëŠ” í•¨ìˆ˜, ê²€ìƒ‰ ì¡°ê±´ì´ ë°”ë€Œë©´ ìƒíƒœë¥¼ ê°±ì‹ í•˜ê³  APIë¥¼ í˜¸ì¶œí•œë‹¤
  const getHistoryList = async (
    newState: Partial<MonitoringHistorySearchState>
  ) => {
    const newSearchState = { ...searchState, ...newState };
    dispatch(monitoringHistorySlice.actions.changeSearchState(newSearchState));
    const response = await getHistories(newSearchState); // ë¹„ë™ê¸° API í˜¸ì¶œí•˜ê¸° dispatch(monitoringHistorySlice.actions.fetchData(response));
  };

  return { searchState, getHistoryList };
}
```
ìŠ¤í† ì–´ì—ì„œ `getHistories API`ë§Œ í˜¸ì¶œí•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ ë°›ì•„ì™€ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ì¼ë°˜ì ì¸ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ `getHistiryList`í•¨ìˆ˜ì—ì„œëŠ” `dispatch`ì½”ë“œë¥¼ ì œì™¸í•˜ë”ë¼ë„ ë‹¤ìŒê³¼ ê°™ì´ API í˜¸ì¶œê³¼ ìƒíƒœ ê´€ë¦¬ ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ í•œë‹¤.

```typescript
enum ApiCallStatus {
  Request,
  None,
}

const API = axios.create();

const setAxiosInterceptor = (store: EnhancedStore) => {
  API.interceptors.request.use((config: AxiosRequestConfig) => {
      const { params, url, method } = config;

      store.dispatch(
        // API ìƒíƒœ ì €ì¥ì„ ìœ„í•´ redux reducer `setApiCall` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤ // ìƒíƒœê°€ `ìš”ì²­ë¨`ì¸ ê²½ìš° APIê°€ Loading ì¤‘ì¸ ìƒíƒœ
        setApiCall({
          status: ApiCallStatus.Request, // API í˜¸ì¶œ ìƒíƒœë¥¼ `ìš”ì²­ë¨`ìœ¼ë¡œ ë³€ê²½
          urlInfo: { url, method },
        })
      );
      return config;
    }, (error) => Promise.reject(error)
  );
  // onSuccess ì‹œ ì¸í„°ì…‰í„°ë¡œ ì²˜ë¦¬í•œë‹¤
  API.interceptors.response.use((response: AxiosResponse) => {
      const { method, url } = response.config;

      store.dispatch(
        setApiCall({
          status: ApiCallStatus.None, // API í˜¸ì¶œ ìƒíƒœë¥¼ `ìš”ì²­ë˜ì§€ ì•ŠìŒ`ìœ¼ë¡œ ë³€ê²½
          urlInfo: { url, method },
        })
      );
      return response?.data?.data || response?.data;
    }, (error: AxiosError) => {
      const {
        config: { url, method },
      } = error;
      store.dispatch(
        setApiCall({
          status: ApiCallStatus.None, // API í˜¸ì¶œ ìƒíƒœë¥¼ `ìš”ì²­ë˜ì§€ ì•ŠìŒ`ìœ¼ë¡œ ë³€ê²½
          urlInfo: { url, method },
        })
      );
      return Promise.reject(error);
    }
  );
};
```

APIë¥¼ í˜¸ì¶œí•  ë•Œ, í˜¸ì¶œí•œ ë’¤ ê·¸ë¦¬ê³  í˜¸ì¶œí•˜ê³  ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ë•Œ ê°ê° `setApiCall`ì„ í˜¸ì¶œí•´ì„œ ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•´ì•¼ í•œë‹¤. ReduxëŠ” ë¹„ë™ê¸° ìƒíƒœê°€ ì•„ë‹Œ ì „ì—­ ìƒíƒœë¥¼ ìœ„í•´ ë§Œë“¤ì–´ì§„ ë¼ì´ë¸ŒëŸ¬ë¦¬ê¸° ë•Œë¬¸ì— ë¯¸ë“¤ì›¨ì–´ë¼ê³  ë¶ˆë¦¬ëŠ” ì—¬ëŸ¬ ë„êµ¬ë¥¼ ë„ì…í•˜ì—¬ ë¹„ë™ê¸° ìƒíƒœë¥¼ ê´€ë¦¬í•œë‹¤. ë”°ë¼ì„œ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ì½”ë“œê°€ ë§ì•„ì§€ëŠ” ë“± ê°„í¸í•˜ê²Œ ë¹„ë™ê¸° ìƒíƒœë¥¼ ê´€ë¦¬í•˜ê¸° ì–´ë ¤ìš´ ìƒí™©ë„ ë°œìƒí•œë‹¤.

ë°˜ë©´ì— MobX ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œëŠ” ì´ëŸ¬í•œ ë¶ˆí¸í•¨ì„ ê°œì„ í•˜ê¸° ìœ„í•´ ë¹„ë™ê¸° ì½œë°± í•¨ìˆ˜ë¥¼ ë¶„ë¦¬í•˜ì—¬ ì•¡ì…˜ìœ¼ë¡œ ë§Œë“¤ê±°ë‚˜ `runInAction`ê³¼ ê°™ì€ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒíƒœ ë³€ê²½ì„ ì²˜ë¦¬í•œë‹¤. ë˜í•œ, `async/await`ë‚˜ `flow`ê°™ì€ ë¹„ë™ê¸° ìƒíƒœ ê´€ë¦¬ë¥¼ ìœ„í•œ ê¸°ëŠ¥ë„ ìˆì–´ ë”ìš± ê°„í¸í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```typescript
import { runInAction, makeAutoObservable } from "mobx";
import type Job from "models/Job";

class JobStore {
  job: Job[] = [];
  constructor() {
    makeAutoObservable(this);
  }
}

type LoadingState = "PENDING" | "DONE" | "ERROR";

class Store {
  job: Job[] = [];
  state: LoadingState = "PENDING";
  errorMsg = "";

  constructor() {
    makeAutoObservable(this);
  }

  async fetchJobList() {
    this.job = [];
    this.state = "PENDING";
    this.errorMsg = "";
    try {
      const projects = await fetchJobList();
      runInAction(() => {
        this.projects = projects;
        this.state = "DONE";
      });
    } catch (e) {
      runInAction(() => {
        this.state = "ERROR";
        this.errorMsg = e.message;
      });
    }
  }
}
```

ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ë¹„ë™ê¸° ì²˜ë¦¬ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ ì•¡ì…˜ì´ ì¶”ê°€ë  ë•Œë§ˆë‹¤ ê´€ë ¨ëœìŠ¤í† ì–´ë‚˜ ìƒíƒœê°€ ê³„ì† ëŠ˜ì–´ë‚œë‹¤. ì´ë¡œ ì¸í•´ ì „ì—­ ìƒíƒœ ê´€ë¦¬ìê°€ ëª¨ë“  ë¹„ë™ê¸° ìƒíƒœì— ì ‘ê·¼í•˜ê³  ë³€ê²½í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ ë¬¸ì œì¸ë° ë§Œì•½ 2ê°œ ì´ìƒì˜ ì»´í¬ë„ŒíŠ¸ê°€ êµ¬ë…í•˜ê³  ìˆëŠ” ë¹„ë™ê¸° ìƒíƒœê°€ ìˆë‹¤ë©´ ì“¸ë°ì—†ëŠ” ë¹„ë™ê¸° í†µì‹ ì´ ë°œìƒí•˜ê±°ë‚˜ ì˜ë„ì¹˜ ì•Šì€ ìƒíƒœ ë³€ê²½ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤.


### í›…ìœ¼ë¡œ í˜¸ì¶œí•˜ê¸°

react-queryë‚˜ useSwr ê°™ì€ í›…ì„ ì‚¬ìš©í•œ ë°©ë²•ì€ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•œ ë°©ì‹ë³´ë‹¤ í›¨ì”¬ ê°„í¸í•œë°, ì´ëŸ¬í•œ í›…ì€ ìºì‹œë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ë™ê¸° í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©°, ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ë°œìƒí–ˆë˜ ì˜ë„ì¹˜ ì•Šì€ ìƒíƒœ ë³€ê²½ì„ ë°©ì§€í•˜ëŠ” ë° ë„ì›€ì´ ëœë‹¤. 

ì•„ë˜ ì½”ë“œëŠ” `Job`ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” í›…ê³¼ `Job` 1ê°œë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ì˜ˆì‹œì´ë‹¤. 
react-queryì—ì„œëŠ” `onSuccess`ì˜µì…˜ì˜ `invalidateQueries`ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • í‚¤ì˜ APIë¥¼ ìœ íš¨í•˜ì§€ ì•Šì€ ìƒíƒœë¡œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

```typescript
// Job ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” í›…
const useFetchJobList = () => {
  return useQuery(["fetchJobList"], async () => {
    const response = await JobService.fetchJobList(); // View Modelì„ ì‚¬ìš©í•´ì„œ ê²°ê³¼
    return new JobList(response);
  });
};

// Job 1ê°œë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” í›…
const useUpdateJob = (
  id: number,
  // Job 1ê°œ update ì´í›„ Query Option
  { onSuccess, ...options }: UseMutationOptions<void, Error, JobUpdateFormValue>
): UseMutationResult<void, Error, JobUpdateFormValue> => {
  const queryClient = useQueryClient();

  return useMutation(
    ["updateJob", id],
    async (jobUpdateForm: JobUpdateFormValue) => {
      await JobService.updateJob(id, jobUpdateForm);
    },
    {
      onSuccess: (
        data: void, // updateJobì˜ return ê°’ì€ ì—†ë‹¤ (status 200ìœ¼ë¡œë§Œ ì„±ê³µ íŒë³„) values: JobUpdateFormValue,
        context: unknown
      ) => {
        // ì„±ê³µ ì‹œ â€˜fetchJobListâ€™ë¥¼ ìœ íš¨í•˜ì§€ ì•ŠìŒìœ¼ë¡œ ì„¤ì • queryClient.invalidateQueries(["fetchJobList"]);
        onSuccess && onSuccess(data, values, context);
      },
      ...options,
    }
  );
};
```

ì´í›„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì¼ë°˜ì ì¸ í›…ì„ í˜¸ì¶œí•˜ëŠ” ê²ƒì²˜ëŸ¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤. `JobList`ì»´í¬ë„ŒíŠ¸ê°€ ë°˜ë“œì‹œ ìµœì‹  ìƒíƒœë¥¼ í‘œí˜„í•˜ë ¤ë©´ í´ë§(polling)ì´ë‚˜ ì›¹ì†Œì¼“(websocket)ë“±ì˜ ë°©ë²•ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤. 


ğŸ“¢ í´ë§(polling)
í´ë¼ì´ì–¸íŠ¸ê°€ ì£¼ê¸°ì ìœ¼ë¡œ ì„œë²„ì— ìš”ì²­ì„ ë³´ë‚´ ë°ì´í„°ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒ. í´ë¼ì´ì–¸íŠ¸ëŠ” ì¼ì •í•œ ì‹œê°„ ê°„ê²©ìœ¼ë¡œ ì„œë²„ì— ìš”ì²­ì„ ë³´ë‚´ê³ , ì„œë²„ëŠ” í•´ë‹¹ ìš”ì²­ì— ëŒ€í•´ ìµœì‹  ìƒíƒœì˜ ë°ì´í„°ë¥¼ ì‘ë‹µìœ¼ë¡œ ë³´ë‚´ì£¼ëŠ” ë°©ì‹.

ê°„ë‹¨í•œ í´ë§ë°©ì‹ìœ¼ë¡œ ìµœì‹  ìƒíƒœë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ì˜ˆì‹œ
```typescript
const JobList: React.FC = () => {
  // ë¹„ë™ê¸° ë°ì´í„°ë¥¼ í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ì—ì„œ ìì²´ ìƒíƒœë¡œ ì €ì¥
  const {
    isLoading,
    isError,
    error,
    refetch,
    data: jobList,
  } = useFetchJobList();

  // ê°„ë‹¨í•œ Polling ë¡œì§, ì‹¤ì‹œê°„ìœ¼ë¡œ í™”ë©´ì´ ê°±ì‹ ë¼ì•¼ í•˜ëŠ” ìš”êµ¬ê°€ ì—†ì–´ì„œ // 30ì´ˆ ê°„ê²©ìœ¼ë¡œ ê°±ì‹ í•œë‹¤
  useInterval(() => refetch(), 30000);

  // Loadingì¸ ê²½ìš°ì—ë„ í™”ë©´ì— í‘œì‹œí•´ì¤€ë‹¤
  if (isLoading) return <LoadingSpinner />;

  // Errorì— ê´€í•œ ë‚´ìš©ì€ 11.3 API ì—ëŸ¬ í•¸ë“¤ë§ì—ì„œ ë” ìì„¸í•˜ê²Œ ë‹¤ë£¬ë‹¤
  if (isError) return <ErrorAlert error={error} />;

  return (
    <>
      {jobList.map((job) => (
        <Job job={job} />
      ))}
    </>
  );
};
```

ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œëŠ” ë¹„ë™ê¸° ìƒíƒœë¥¼ ë³€ê²½í•˜ëŠ” ì½”ë“œê°€ ì ì  ì¶”ê°€ë˜ë©´ ì „ì—­ ìƒíƒœ ê´€ë¦¬ ìŠ¤í† ì–´ê°€ ë¹„ëŒ€í•´ì§€ê¸° ë•Œë¬¸ì— ë‹¨ìˆœíˆ ìƒíƒœë¥¼ ë³€ê²½í•˜ëŠ” ì•¡ì…˜ì´ ì¦ê°€í•˜ëŠ” ê²ƒë¿ë§Œ ì•„ë‹ˆë¼ ì „ì—­ ìƒíƒœ ìì²´ë„ ë³µì¡í•´ì§„ë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ ì—ëŸ¬ ë°œìƒ, ë¡œë”© ì¤‘ ë“±ê³¼ ê°™ì€ ìƒíƒœëŠ” ì „ì—­ìœ¼ë¡œ ê´€ë¦¬í•  í•„ìš”ê°€ ê±°ì˜ ì—†ë‹¤. ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ê°€ ì—ëŸ¬ ìƒíƒœì¸ì§€, ì„±ê³µ ìƒíƒœì¸ì§€ë¥¼ êµ¬ë…í•˜ëŠ” ê²½ìš° ì»´í¬ë„ŒíŠ¸ì˜ ê²°í•©ë„ì™€ ë³µì¡ë„ê°€ ë†’ì•„ì ¸ ìœ ì§€ë³´ìˆ˜ë¥¼ ì–´ë µê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤. ì´ëŸ° ê³ ë¯¼ìœ¼ë¡œ ì¸í•´ ë¹„ë™ê¸° í†µì‹ ì„ react-queryë¥¼ ì‚¬ìš©í•´ì„œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ”ë° react-queryëŠ” ì „ì—­ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì•„ë‹Œ ë§Œí¼ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¤‘ì—ì„œ ê°€ì¥ ë›°ì–´ë‚˜ë‹¤ëŠ” ì˜ë¯¸ê°€ ì•„ë‹ˆë‹¤.
ì–´ë–¤ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„ íƒí• ì§€ëŠ” í”„ë¡œì íŠ¸ì˜ ë„ë©”ì¸, ê°œë°œìì˜ í•™ìŠµ ê³¡ì„  ê·¸ë¦¬ê³  ê¸°ì¡´ ì½”ë“œì™€ì˜ í˜¸í™˜ì„± ë“±ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤.


## API ì—ëŸ¬ í•¸ë“¤ë§

ë¹„ë™ê¸° API í˜¸ì¶œì„ í•˜ë‹¤ ë³´ë©´ ìƒíƒœ ì½”ë“œì— ë”°ë¥¸ ì—ëŸ¬ í˜¹ì€ CORS ì—ëŸ¬ ë“± ë‹¤ì–‘í•œ ì—ëŸ¬ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ì½”ë“œì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì—ëŸ¬ ìƒí™©ì— ëŒ€í•´ ëª…ì‹œì ì¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ ìœ ì§€ë³´ìˆ˜ê°€ ìš©ì´í•´ì§€ê³ , ì‚¬ìš©ìì—ê²Œë„ êµ¬ì²´ì ì¸ ì—ëŸ¬ ìƒí™©ì„ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.

### íƒ€ì… ê°€ë“œ í™œìš©í•˜ê¸°

Axios ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œëŠ” Axios ì—ëŸ¬ì— ëŒ€í•´ `isAxiosError`ë¼ëŠ” íƒ€ì… ê°€ë“œë¥¼ ì œê³µí•˜ê³  ìˆë‹¤. ì´ íƒ€ì… ê°€ë“œë¥¼ ì§ì ‘ ì‚¬ìš©í•  ìˆ˜ë„ ìˆì§€ë§Œ, ì„œë²„ ì—ëŸ¬ì„ì„ ëª…í™•í•˜ê²Œ í‘œì‹œí•˜ê³  ì„œë²„ì—ì„œ ë‚´ë ¤ì£¼ëŠ” ì—ëŸ¬ ì‘ë‹µ ê°ì²´ì— ëŒ€í•´ì„œë„ êµ¬ì²´ì ìœ¼ë¡œ ì •ì˜í•¨ìœ¼ë¡œì¨ ì—ëŸ¬ ê°ì²´ê°€ ì–´ë–¤ ì†ì„±ì„ ê°€ì¡ŒëŠ”ì§€ë¥¼ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.

```typescript
interface ErrorResponse {
  status: string;
  serverDateTime: string;
  errorCode: string;
  errorMessage: string;
}
```

`ErrorResponse` ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì²˜ë¦¬í•´ì•¼í•  Axios ì—ëŸ¬ í˜•íƒœëŠ” `Axios<ErrorResponse>`ë¡œ í‘œí˜„í•  ìˆ˜ ìˆìœ¼ë©° ë‹¤ìŒê³¼ ê°™ì´ íƒ€ì… ê°€ë“œë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

```typescript
function isServerError(error: unknown): error is AxiosError<ErrorResponse> {
  return axios.isAxiosError(error);
}
// ì‚¬ìš©ì ì •ì˜ íƒ€ì… ê°€ë“œë¥¼ ì •ì˜í•  ë•ŒëŠ” íƒ€ì… ê°€ë“œ í•¨ìˆ˜ì˜ ë°˜í™˜ íƒ€ì…ìœ¼ë¡œ
// parameterName is Type í˜•íƒœì˜ íƒ€ì… ëª…ì œë¥¼ ì •ì˜í•´ì£¼ëŠ” ê²Œ ì¢‹ë‹¤.
// ì´ë•Œ parameterNameì€ íƒ€ì… ê°€ë“œ í•¨ìˆ˜ì˜ ì‹œê·¸ë‹ˆì²˜ì— í¬í•¨ëœ ë§¤ê°œë³€ìˆ˜ì—¬ì•¼ í•œë‹¤.
```

```typescript
interface ErrorResponse {
  status: string;
  serverDateTime: string;
  errorCode: string;
  errorMessage: string;
}

function isServerError(error: unknown): error is AxiosError<ErrorResponse> {
  return axios.isAxiosError(error);
}
// ì‚¬ìš©ì ì •ì˜ íƒ€ì… ê°€ë“œë¥¼ ì •ì˜í•  ë•ŒëŠ” íƒ€ì… ê°€ë“œ í•¨ìˆ˜ì˜ ë°˜í™˜ íƒ€ì…ìœ¼ë¡œ
// parameterName is Type í˜•íƒœì˜ íƒ€ì… ëª…ì œë¥¼ ì •ì˜í•´ì£¼ëŠ” ê²Œ ì¢‹ë‹¤.
// ì´ë•Œ parameterNameì€ íƒ€ì… ê°€ë“œ í•¨ìˆ˜ì˜ ì‹œê·¸ë‹ˆì²˜ì— í¬í•¨ëœ ë§¤ê°œë³€ìˆ˜ì—¬ì•¼ í•œë‹¤.

const onClickDeleteHistoryButton = async (id: string) => {
  try {
    await axios.post("https://....", { id });

    alert("ì£¼ë¬¸ ë‚´ì—­ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
  } catch (error: unknown) {
    if (isServerError(error) && error.response && error.response.data.errorMessage) {
      // ì„œë²„ ì—ëŸ¬ì¼ ë•Œì˜ ì²˜ë¦¬ì„ì„ ëª…ì‹œì ìœ¼ë¡œ ì•Œ ìˆ˜ ìˆë‹¤ setErrorMessage(e.response.data.errorMessage);
      return;
    }
    setErrorMessage("ì¼ì‹œì ì¸ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”");
  }
};
```

ì´ì²˜ëŸ¼ íƒ€ì… ê°€ë“œë¥¼ í™œìš©í•˜ë©´ ì„œë²„ ì—ëŸ¬ë¥¼ ëª…ì‹œì ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.


### ì—ëŸ¬ ì„œë¸Œí´ë˜ì‹±í•˜ê¸°
ì‹¤ì œ ìš”ì²­ì„ ì²˜ë¦¬í•  ë•Œ ë‹¨ìˆœí•œ ì„œë²„ ì—ëŸ¬ë„ ë°œìƒí•˜ì§€ë§Œ ì¸ì¦ ì •ë³´ ì—ëŸ¬, ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬, íƒ€ì„ì•„ì›ƒ ì—ëŸ¬ ê°™ì€ ë‹¤ì–‘í•œ ì—ëŸ¬ê°€ ë°œìƒí•˜ê¸°ë„ í•œë‹¤. ì´ë¥¼ ë”ìš± ëª…ì‹œì ìœ¼ë¡œ í‘œì‹œí•˜ê¸° ìœ„í•´ ì„œë¸Œí´ë˜ì‹±ì„ í™œìš©í•  ìˆ˜ ìˆë‹¤.

ğŸ“¢ ì„œë¸Œ í´ë˜ì‹±(Subclassing)
ê¸°ì¡´(ë¶€ëª¨) í´ë˜ìŠ¤ë¥¼ í™•ì¥í•˜ì—¬ ìƒˆë¡œìš´(ìì‹) í´ë˜ìŠ¤ë¥¼ ë§Œë“œëŠ” ê³¼ì •ì„ ë§í•˜ë‚Ÿ. ìƒˆë¡œìš´ í´ë˜ìŠ¤ëŠ” ìƒìœ„ í´ë˜ìŠ¤ì˜ ëª¨ë“  ì†ì„±ê³¼ ë©”ì„œë“œë¥¼ ìƒì†ë°›ì•„ ì‚¬ìš©í•  ìˆ˜ ìˆê³  ì¶”ê°€ì ì¸ ì†ì„±ê³¼ ë©”ì„œë“œë¥¼ ì •ì˜í•  ìˆ˜ ìˆë‹¤.


ì‚¬ìš©ìì—ê²Œ ì£¼ë¬¸ ë‚´ì—­ì„ ë³´ì—¬ì£¼ê¸° ìœ„í•´ ì„œë²„ì— ì£¼ë¬¸ ë‚´ì—­ì„ ìš”ì²­í•˜ëŠ” ì½”ë“œ
```typescript
const getOrderHistory = async (page: number): Promise<History> => {
  try {
    const { data } = await axios.get(`https://some.site?page=${page}`);
    const history = await JSON.parse(data);

    return history;
  } catch (error) {
    alert(error.message);
  }
};
```

ìœ„ ì½”ë“œëŠ” ì£¼ë¬¸ ë‚´ì—­ì„ ìš”ì²­í•  ë•Œ ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ ì—ëŸ¬ ë©”ì„¸ì§€ë¥¼ ì–¼ëŸ¿ì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ í‘œì‹œí•´ì¤€ë‹¤. ì´ë•Œ "ë¡œê·¸ì¸ ì •ë³´ê°€ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤." , "ìœ íš¨í•˜ì§€ ì•Šì€ ìš”ì²­ ë°ì´í„°ì…ë‹ˆë‹¤." ì™€ ê°™ì´ ì„œë²„ì—ì„œ ì „ë‹¬ëœ ì—ëŸ¬ ë©”ì„¸ì§€ë¥¼ ë³´ê³  ì‚¬ìš©ìëŠ” ì–´ë–¤ ì—ëŸ¬ê°€ ë°œìƒí•œ ê²ƒì¸ì§€ íŒë‹¨í•  ìˆ˜ ìˆë”ë¼ë„ ê°œë°œìëŠ” ì‚¬ìš©ì ë¡œê·¸ì¸ ì •ë³´ê°€ ë§Œë£Œë˜ì—ˆëŠ”ì§€, íƒ€ì„ì•„ì›ƒì´ ë°œìƒí•œê±´ì§€ êµ¬ë¶„í•  ìˆ˜ ì—†ë‹¤.

ì´ë•Œ ì„œë¸Œí´ë˜ì‹±ì„ í™œìš©í•˜ë©´ ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ë•Œ ì½”ë“œìƒì—ì„œ ì–´ë–¤ ì—ëŸ¬ì¸ì§€ë¥¼ ë°”ë¡œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ë˜í•œ ì—ëŸ¬ ì¸ìŠ¤í„´ìŠ¤ê°€ ë¬´ì—‡ì¸ì§€ì— ë”°ë¼ ì—ëŸ¬ ì²˜ë¦¬ ë°©ì‹ì„ ë‹¤ë¥´ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.

```typescript
class OrderHttpError extends Error {
  private readonly privateResponse: AxiosResponse<ErrorResponse> | undefined;

  constructor(message?: string, response?: AxiosResponse<ErrorResponse>) {
    super(message);
    this.name = "OrderHttpError"; // ì—ëŸ¬ ì´ë¦„ ì„¤ì •
    this.privateResponse = response; // ì„œë²„ ì‘ë‹µ ì €ì¥
  }

  get response(): AxiosResponse<ErrorResponse> | undefined {
    return this.privateResponse; // ì„œë²„ ì‘ë‹µ ë°˜í™˜
  }
}

class NetworkError extends Error {
  constructor(message = "") {
    super(message);
    this.name = "NetworkError"; // ì—ëŸ¬ ì´ë¦„ ì„¤ì •
  }
}

class UnauthorizedError extends Error {
  constructor(message: string, response?: AxiosResponse<ErrorResponse>) {
    super(message, response);
    this.name = "UnauthorizedError"; // ì—ëŸ¬ ì´ë¦„ ì„¤ì •
  }
}
```

ê·¸ë‹¤ìŒ ì•„ë˜ì™€ ê°™ì´ ì—ëŸ¬ ê°ì²´ë¥¼ ìƒì†í•œ `OrderHttpError`, `NetworkError`, `UnauthorizedError`ë¥¼ ì •ì˜í•œë‹¤. Axiosë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ ì¡°ê±´ì— ë”°ë¼ ì¸í„°ì…‰í„°ì—ì„œ ì í•©í•œ ì—ëŸ¬ ê°ì²´ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.

```typescript
const httpErrorHandler = (
  error: AxiosError<ErrorResponse> | Error
): Promise<Error> => {
  let promiseError: Promise<Error>;

  if (axios.isAxiosError(error)) {
  // Axios ì—ëŸ¬ ì²˜ë¦¬
    if (Object.is(error.code, "ECONNABORTED")) {
      promiseError = Promise.reject(new TimeoutError()); // íƒ€ì„ì•„ì›ƒ ì—ëŸ¬
    } else if (Object.is(error.message, "Network Error")) {
      promiseError = Promise.reject(new NetworkError()); // ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬
    } else {
      // ì„œë²„ ì‘ë‹µ ì²˜ë¦¬
      const { response } = error as AxiosError<ErrorResponse>;
      switch (response?.status) {
        case HttpStatusCode.UNAUTHORIZED: // ì¸ì¦ ì‹¤íŒ¨ ì—ëŸ¬
          promiseError = Promise.reject(
            new UnauthorizedError(response?.data.message, response)
          );
          break;
        default: // ê¸°íƒ€ ì„œë²„ ì—ëŸ¬
          promiseError = Promise.reject(
            new OrderHttpError(response?.data.message, response)
          );
      }
    }
  } else {
    promiseError = Promise.reject(error);
  }

  return promiseError;
};
```

ë‹¤ì‹œ ìš”ì²­ ì½”ë“œë¡œ ëŒì•„ì™€ì„œ ë‹¤ìŒê³¼ ê°™ì´ í™œìš©í•  ìˆ˜ ìˆë‹¤.

```typescript
const alert = (meesage: string, { onClose }: { onClose?: () => void }) => {};

const onActionError = (
  error: unknown,
  params?: Omit<AlertPopup, "type" | "message">
) => {
  if (error instanceof UnauthorizedError) {
    onUnauthorizedError(
      error.message,
      errorCallback?.onUnauthorizedErrorCallback
    );
  } else if (error instanceof NetworkError) {
    alert("ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì´ ì›í™œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.", {
      onClose: errorCallback?.onNetworkErrorCallback,
    });
  } else if (error instanceof OrderHttpError) {
    alert(error.message, params);
  } else if (error instanceof Error) {
    alert(error.message, params);
  } else {
    alert(defaultHttpErrorMessage, params);
  }

  const getOrderHistory = async (page: number): Promise<History> => {
    try {
      const { data } = await fetchOrderHistory({ page });
      const history = await JSON.parse(data);

      return history;
    } catch (error) {
      onActionError(error);
    }
  };
};
```

ì´ì²˜ëŸ¼ ì—ëŸ¬ë¥¼ ì„œë¸Œí´ë˜ì‹±í•´ì„œ í‘œí˜„í•˜ë©´ ëª…ì‹œì ìœ¼ë¡œ ì—ëŸ¬ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆë‹¤. `error` `instanceof` `OrderHttpError`ì™€ ê°™ì´ ì‘ì„±ëœ íƒ€ì… ê°€ë“œë¬¸ì„ í†µí•´ ì½”ë“œìƒì—ì„œ ì—ëŸ¬ í•¸ë“¤ë§ì— ëŒ€í•œ ë¶€ë¶„ì„ í•œëˆˆì— ë³¼ ìˆ˜ ìˆë‹¤.



### ì¸í„°ì…‰í„°ë¥¼ í™œìš©í•œ ì—ëŸ¬ ì²˜ë¦¬
Axios ê°™ì€ í˜ì¹­ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ì¸í„°ì…‰í„° ê¸°ëŠ¥ì„ ì œê³µí•˜ë‚Ÿ. ì´ë¥¼ ì‚¬ìš©í•˜ë©´ HTTPì—ëŸ¬ì— ì¼ê´€ëœ ë¡œì§ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.

```typescript
const httpErrorHandler = (
  error: AxiosError<ErrorResponse> | Error
): Promise<Error> => {
  (error) => {
    // 401 ì—ëŸ¬ì¸ ê²½ìš° ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
    if (error.response && error.response.status === 401) {
      window.location.href = `${backOfficeAuthHost}/login?targetUrl=${window.location.href}`;
    }
    return Promise.reject(error);
  };
};

orderApiRequester.interceptors.response.use(
  (response: AxiosResponse) => response,
  httpErrorHandler
);
```


### ì—ëŸ¬ ë°”ìš´ë”ë¦¬ë¥¼ í™œìš©í•œ ì—ëŸ¬ ì²˜ë¦¬

ì—ëŸ¬ ë°”ìš´ë”ë¦¬ëŠ” ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•  ë•Œ ê³µí†µìœ¼ë¡œ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ì´ë‹¤. ì—ëŸ¬ ë°”ìš´ë”ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ í•˜ìœ„ì— ìˆëŠ” ì»´í¬ë„ŒíŠ¸ì—ì„œ ë°œìƒí•œ ì—ëŸ¬ë¥¼ ìºì¹˜í•˜ê³ , í•´ë‹¹ ì—ëŸ¬ë¥¼ ê°€ì¥ ê°€ê¹Œìš´ ë¶€ëª¨ ì—ëŸ¬ ë°”ìš´ë”ë¦¬ì—ì„œ ì²˜ë¦¬í•˜ê²Œ í•  ìˆ˜ ìˆë‹¤. ì—ëŸ¬ ë°”ìš´ë”ë¦¬ëŠ” ì—ëŸ¬ê°€ ë°œìƒí•œ ì»´í¬ë„ŒíŠ¸ ëŒ€ì‹ ì— ì—ëŸ¬ ì²˜ë¦¬ë¥¼ í•˜ê±°ë‚˜ ì˜ˆìƒì¹˜ ëª»í•œ ì—ëŸ¬ë¥¼ ê³µí†µ ì²˜ë¦¬í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```typescript
import React, { ErrorInfo } from "react";
import ErrorPage from "pages/ErrorPage";

interface ErrorBoundaryProps {}

interface ErrorBoundaryState {
  hasError: boolean;
}

class ErrorBoundary extends React.Component<
  ErrorBoundaryProps,
  ErrorBoundaryState
> {
  constructor(props: ErrorBoundaryProps) {
    super(props);
    this.state = { hasError: false };
  }

  static getDerivedStateFromError(): ErrorBoundaryState {
    return { hasError: true };
  }

  componentDidCatch(error: Error, errorInfo: ErrorInfo): void {
    this.setState({ hasError: true });

    console.error(error, errorInfo);
  }

  render(): React.ReactNode {
    const { children } = this.props;
    const { hasError } = this.state;

    return hasError ? <ErrorPage /> : children;
  }
}

const App = () => {
  return (
    <ErrorBoundary>
      <OrderHistoryPage />
    </ErrorBoundary>
  );
};
```

ì´ì²˜ëŸ¼ ì‘ì„±í•˜ë©´ `OrderHistoryPage` ì»´í¬ë„ŒíŠ¸ ë‚´ì—ì„œ ì²˜ë¦¬ë˜ì§€ ì•Šì€ ì—ëŸ¬ê°€ ìˆì„ ë•Œ ì—ëŸ¬ ë°”ìš´ë”ë¦¬ì—ì„œ ì—ëŸ¬ í˜ì´ì§€ë¥¼ ë…¸ì¶œí•œë‹¤. ì´ì™¸ì—ë„ ì—ëŸ¬ ë°”ìš´ë”ë¦¬ì— ë¡œê·¸ë¥¼ ë³´ë‚´ëŠ” ì½”ë“œë¥¼ ì¶”ê°€í•˜ì—¬ ì˜ˆìƒì¹˜ ëª»í•œ ì—ëŸ¬ì˜ ë°œìƒ ì—¬ë¶€ë¥¼ ì¶”ì í•  ìˆ˜ ìˆê²Œ ëœë‹¤.



### ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œì˜ ì—ëŸ¬ ì²˜ë¦¬

Reduxì˜ ì—ëŸ¬ ì²˜ë¦¬ ë°©ë²•
```typescript
// API í˜¸ì¶œì— ê´€í•œ api call reducer
const apiCallSlice = createSlice({
  name: "apiCall",
  initialState,
  reducers: {
    setApiCall: (state, { payload: { status, urlInfo } }) => {
      /* API Stateë¥¼ ì±„ìš°ëŠ” logic */
    },
    setApiCallError: (state, { payload }: PayloadAction<any>) => {
      state.error = payload;
    },
  },
});

const API = axios.create();

const setAxiosInterceptor = (store: EnhancedStore) => {
  /* ì¤‘ë³µ ì½”ë“œ ìƒëµ */
  // onSuccessì‹œ ì²˜ë¦¬ë¥¼ ì¸í„°ì…‰í„°ë¡œ ì²˜ë¦¬í•œë‹¤
  API.interceptors.response.use(
    (response: AxiosResponse) => {
      const { method, url } = response.config;

      store.dispatch(
        setApiCall({
          status: ApiCallStatus.None, // API í˜¸ì¶œ ìƒíƒœë¥¼ `ìš”ì²­ë˜ì§€ ì•ŠìŒ`ìœ¼ë¡œ ë³€ê²½
          urlInfo: { url, method },
        })
      );

      return response?.data?.data || response?.data;
    },
    (error: AxiosError) => {
      // 401 unauthorized
      if (error.response?.status === 401) {
        window.location.href = error.response.headers.location;

        return;
      }
      // 403 forbidden
      else if (error.response?.status === 403) {
        window.location.href = error.response.headers.location;
        return;
      }
      // ê·¸ ì™¸ì—ëŠ” í™”ë©´ì— alert ë„ìš°ê¸°
      else {
        message.error(`[ì„œë²„ ìš”ì²­ ì—ëŸ¬]: ${error?.response?.data?.message}`);
      }

      const {
        config: { url, method },
      } = error;

      store.dispatch(
        setApiCall({
          status: ApiCallStatus.None, // API í˜¸ì¶œ ìƒíƒœë¥¼ `ìš”ì²­ë˜ì§€ ì•ŠìŒ`ìœ¼ë¡œ ë³€ê²½
          urlInfo: { url, method },
        })
      );

      return Promise.reject(error);
    }
  );
};
```

ì—ëŸ¬ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ì§€ ì•Šê³  ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤ë©´ ë°”ë¡œ ì²˜ë¦¬í•˜ê³ , ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ `reject`ë¡œ ë„˜ê²¨ì¤€ë‹¤. ì´í›„ ì•¡ì…˜ì„ ì •ì˜í•˜ë©´ì„œ `setApiCallError`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì—ëŸ¬ë¥¼ ìƒíƒœë¡œ ì²˜ë¦¬í•œë‹¤.

```typescript
const fetchMenu = createAsyncThunk(
  FETCH_MENU_REQUEST,
  async ({ shopId, menuId }: FetchMenu) => {
    try {
      const data = await api.fetchMenu(shopId, menuId);
      return data;
    } catch (error) {
      setApiCallError({ error });
    }
  }
);
```

ì´ë ‡ê²Œ ì €ì¥ëœ ì—ëŸ¬ëŠ” ì»´í¬ë„ŒíŠ¸ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë§Œì•½ MobXë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´ ì£¼ë¡œ ìŠ¤í† ì–´ì—ì„œ ì—ëŸ¬ í•¸ë“¤ë§ì„ í•œë‹¤. ì™¸ë¶€ì—ì„œëŠ” ë³„ë„ë¡œ ì„±ê³µ ë° ì‹¤íŒ¨ ë“±ì— ëŒ€í•´ ì°¸ì¡°í•˜ì§€ ì•Šìœ¼ë©° ë¹„ë™ê¸° ë™ì‘ì˜ ìˆ˜í–‰ ë° ê²°ê´ê°’ì„ ì‚¬ìš©í•œë‹¤.

```typescript
class JobStore {
  jobs: Job[] = [];
  state: LoadingState = "PENDING"; // "PENDING" | "DONE" | "ERROR"; errorMsg = "";

  constructor() {
    makeAutoObservable(this);
  }

  async fetchJobList() {
    this.jobs = [];
    this.state = "PENDING";
    this.errorMsg = "";

    try {
      const projects = await fetchJobList();

      runInAction(() => {
        this.projects = projects;
        this.state = "DONE";
      });
    } catch (e) {
      runInAction(() => {
        // ì—ëŸ¬ í•¸ë“¤ë§ ì½”ë“œë¥¼ ì‘ì„±
        this.state = "ERROR";
        this.errorMsg = e.message;
        showAlert();
      });
    }
  }

  get isLoading(): boolean {
    return state === "PENDING";
  }
}

const JobList = (): JSX.Element => {
  const [jobStore] = useState(() => new JobStore());

  if (jobStore.job.isLoading) {
    return <Loader />;
  }

  return (
    <>
      {jobStore.jobs.map((job) => (
        <Item job={job} />
      ))}
    </>
  );
};
```




### react-queryë¥¼ í™œìš©í•œ ì—ëŸ¬ ì²˜ë¦¬

react-queryë‚˜ swrê³¼ ê°™ì€ ë°ì´í„° í˜ì¹­ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ìš”ì²­ì— ëŒ€í•œ ìƒíƒœë¥¼ ë°˜í™˜í•´ì£¼ê¸° ë•Œë¬¸ì— ìš”ì²­ ìƒíƒœë¥¼ í™•ì¸í•˜ê¸° ì‰½ë‹¤.

```typescript
const JobComponent: React.FC = () => {
  const { isError, error, isLoading, data } = useFetchJobList();
  if (isError) {
    return (
      <div>{`${error.message}ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.`}</div>
    );
  }
  if (isLoading) {
    return <div>ë¡œë”© ì¤‘ì…ë‹ˆë‹¤.</div>;
  }
  return (
    <>
      {data.map((job) => (
        <JobItem key={job.id} job={job} />
      ))}
    </>
  );
};
```





### ê·¸ ë°–ì˜ ì—ëŸ¬ ì²˜ë¦¬

API ì‘ë‹µì€ ì£¼ë¡œ ì„±ê³µ ì‹œ 2xx ì½”ë“œë¥¼, ì‹¤íŒ¨ì‹œ 4xx, 5xx ì½”ë“œë¥¼ ë°˜í™˜í™˜ë‹¤. ê·¸ëŸ¬ë‚˜ ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ì—ì„œì˜ ìœ íš¨ì„± ê²€ì¦ì— ì˜í•´ ì¶”ê°€ëœ ì»¤ìŠ¤í…€ ì—ëŸ¬ëŠ” ì„±ê³µ ì‘ë‹µê³¼ í•¨ê»˜ ì‘ë‹µ ë°”ë””ì— ë³„ë„ì˜ ìƒíƒœ ì½”ë“œë¥¼ ì „ë‹¬í•˜ê¸°ë„ í•œë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ ì¥ë°”êµ¬ë‹ˆì—ì„œ ì£¼ë¬¸ì„ ìƒì„±í•˜ëŠ” APIê°€ ë‹¤ìŒê³¼ ê°™ì€ ì»¤ìŠ¤í…€ ì—ëŸ¬ë¥¼ ë°˜í™˜í•˜ëŠ” ê²ƒì´ ìˆë‹¤.
```
httpStauts: 200
{
  "Status": "C20005, // ì„±ê³µì¸ ê²½ìš° SUCCESS
  "message": "ì¥ë°”êµ¬ë‹ˆì— í’ˆì ˆëœ ë©”ë‰´ê°€ ìˆìŠµë‹ˆë‹¤."
}
```
ìœ„ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ìš”ì²­ í•¨ìˆ˜ ë‚´ì—ì„œ ì¡°ê±´ë¬¸ìœ¼ë¡œ status(ìƒíƒœ)ë¥¼ ë¹„êµí•  ìˆ˜ ìˆë‹¤.

```typescript
const successHandler = (response: CreateOrderResponse) => {
  if (response.status === "SUCCESS") {
    // SUCCESSë©´ ì‹¤í–‰í•  ë¡œì§
    return;
  }
  throw new CustomError(response.status, response.message);
};
const createOrder = (data: CreateOrderData) => {
  try {
    const response = apiRequester.post("https://...", data);

    successHandler(response);
  } catch (error) {
    errorHandler(error);
  }
};
```

ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ ê°„ë‹¨í•˜ê²Œ ì»¤ìŠ¤í…€ ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ë ‡ê²Œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” APIê°€ ë§ì„ ë•ŒëŠ” ë§¤ë²ˆ `if (response.status === "SUCCESS")`ì™€ ê°™ì€ êµ¬ë¬¸ì„ ì¶”ê°€í•´ì•¼ í•œë‹¤. ë§Œì•½ ì»¤ìŠ¤í…€ ì—ëŸ¬ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ” ìš”ì²­ì„ ì¼ê´„ì ìœ¼ë¡œ ì—ëŸ¬ë¡œ ì²˜ë¦¬í•˜ê³  ì‹¶ë‹¤ë©´ Axios ë“±ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê¸°ëŠ¥ì„ í™œìš©í•˜ë©´ ëœë‹¤. íŠ¹ì • í˜¸ìŠ¤íŠ¸ì— ëŒ€í•œ API requesterë¥¼ ë³„ë„ë¡œ ì„ ì–¸í•˜ê³  ìƒíƒœ ì½”ë“œ ë¹„êµ ë¡œì§ì„ ì¸í„°ì…‰í„°ì— ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.

```tpyescript
export const apiRequester: AxiosInstance = axios.create({
  baseURL: orderApiBaseUrl,
  ...defaultConfig,
});

export const httpSuccessHandler = (response: AxiosResponse) => {
  if (response.data.status !== "SUCCESS") {
    throw new CustomError(response?.data.message, response);
  }

  return response;
};

apiRequester.interceptors.response.use(httpSuccessHandler, httpErrorHandler);

const createOrder = (data: CreateOrderData) => {
  try {
    const response = apiRequester.post("https://...", data);

    successHandler(response);
  } catch (error) {
    // statusê°€ SUCCESSê°€ ì•„ë‹Œ ê²½ìš° ì—ëŸ¬ë¡œ ì „ë‹¬ëœë‹¤
    errorHandler(error);
  }
};
```

ì¸í„°ì…‰í„°ì—ì„œ ì»¤ìŠ¤í…€ ì—ëŸ¬ë¥¼ íŒë‹¨í•˜ê³  ì—ëŸ¬ë¥¼ ë˜ì§ìœ¼ë¡œì¨ ì™¸ë¶€ì—ì„œ 200ë²ˆ ëŒ€ë¡œ ì˜¨ ì‘ë‹µì´ë¼ë„ 400ë²ˆ ëŒ€, 500ë²ˆ ëŒ€ ê°™ì€ ì—ëŸ¬ë¡œ ë°›ê²Œ ëœë‹¤. 





## API ëª¨í‚¹

í”„ë¡ íŠ¸ì•¤ë“œ ê°œë°œì„ í•˜ë‹¤ë³´ë©´ ì„œë²„ APIê°€ ì™„ì„±ë˜ê¸° ì „ì— ê°œë°œì„ ì§„í–‰í•´ì•¼ í•˜ëŠ” ì¼ì´ ì¢…ì¢… ìƒê¸´ë‹¤. API ëª¨í‚¹ì€ ì‹¤ì œ API ì„œë²„ê°€ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ê±°ë‚˜ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ì‹¤ì œ APIë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šê³ ë„ ê°œë°œì´ë‚˜ í…ŒìŠ¤íŠ¸ë¥¼ í•  ìˆ˜ ìˆë„ë¡ API ì‘ë‹µì„ ë¯¸ë¦¬ ì •ì˜í•˜ê³  ì‹œë®¬ë ˆì´ì…˜í•˜ëŠ” ë°©ë²•ì´ë‹¤. 
ëª¨í‚¹ì„ í™œìš©í•˜ë©´ devì„œë²„ê°€ ë¶ˆì•ˆì •í•˜ê±°ë‚˜ AWS ë“±ì— ë¬¸ì œê°€ ìƒê²¼ì„ ë•Œì™€ ê°™ì€ ì„œë²„ ìƒíƒœì— ë¬¸ì œê°€ ë°œìƒí•œ ê²½ìš°ì—ë„ ì„œë²„ì˜ ì˜í–¥ì„ ë°›ì§€ ì•Šê³  í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì„ í•  ìˆ˜ ìˆê²Œ ëœë‹¤.





### JSONíŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸°
ê°„ë‹¨í•œ ì¡°íšŒë§Œ í•„ìš”í•œ ê²½ìš°ì—ëŠ” jsoníŒŒì¼ì„ ë§Œë“¤ê±°ë‚˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ì•ˆì— JSON í˜•ì‹ì˜ ì •ë³´ë¥¼ ì €ì¥í•˜ê³  `export` í•´ì£¼ëŠ” ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤. ì´í›„ `GET` ìš”ì²­ì— íŒŒì¼ ê²½ë¡œë¥¼ ì‚½ì…í•´ì£¼ë©´ì„œ ì¡°íšŒ ì‘ë‹µìœ¼ë¡œ ì›í•˜ëŠ” ê°’ì„ ë°›ì„ ìˆ˜ ìˆë‹¤.

```typescript
// mock/service.ts
const SERVICES: Service[] = [
  {
    id: 0,
    name: "ë°°ë‹¬ì˜ë¯¼ì¡±",
  },
  {
    id: 1,
    name: "ë§Œí™”ê²½",
  },
];

export default SERVICES;

// api.ts
const getServices = ApiRequester.get("/mock/service.ts");
```

ì´ ë°©ë²•ì€ ë³„ë„ì˜ í™˜ê²½ ì„¤ì •ì´ í•„ìš”í•˜ì§€ ì•Šì•„ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. í”„ë¡œì íŠ¸ ì´ˆê¸° ë‹¨ê³„ì—ì„œ ì‚¬ìš©ìì˜ ì¸í„°ë ‰ì…˜ì—†ì´ ë¹ ë¥´ê²Œ ëª©ì—…ì„ êµ¬ì¶•í•  ë•Œ ìœ ìš©í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ ë°©ë²•ì€ ì‹¤ì œ API URLë¡œ ìš”ì²­í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¯€ë¡œ ì¶”í›„ì— ìš”ì²­ ê²½ë¡œë¥¼ ìˆ˜ì •í•´ì•¼ í•œë‹¤.





### NextApiHandler í™œìš©í•˜ê¸°

í”„ë¡œì íŠ¸ì—ì„œ Next.jsë¥¼ ì‚¬ìš©í•œë‹¤ë©´ NextApiHandlerë¥¼ í™œìš©í•  ìˆ˜ ìˆë‹¤. NextApiHandlerëŠ” í•˜ë‚˜ì˜ íŒŒì¼ ì•ˆì— í•˜ë‚˜ì˜ í•¸ë“¤ëŸ¬ë¥¼ default exportë¡œ êµ¬í˜„í•´ì•¼ í•˜ë©° íŒŒì¼ì˜ ê²½ë¡œê°€ ìš”ì²­ ê²½ë¡œê°€ ëœë‹¤.

í•¸ë“¤ëŸ¬ë¥¼ ì •ì˜í•˜ëŠ” ê²ƒì€ ì‘ë‹µí•˜ê³ ì í•˜ëŠ” ê°’ì„ ì •ì˜í•˜ê³  í•¸ë“¤ëŸ¬ ì•ˆì—ì„œ ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µì„ ì •ì˜í•œë‹¤. í•¸ë“¤ëŸ¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ë‹¨ìˆœíˆ íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ê²ƒê³¼ ë‹¤ë¥´ê²Œ ì¤‘ê°„ ê³¼ì •ì— ì‘ë‹µ ì²˜ë¦¬ ë¡œì§ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.

```typescript
// api/mock/brand
import { NextApiHandler } from "next";

const BRANDS: Brand[] = [
  {
    id: 1,
    label: "ë°°ë¯¼ìŠ¤í† ì–´",
  },
  {
    id: 2,
    label: "ë¹„ë§ˆíŠ¸",
  },
];

const handler: NextApiHandler = (req, res) => {
  // request ìœ íš¨ì„± ê²€ì¦
  res.json(BRANDS);
};

export default handler;
```




### API ìš”ì²­ í•¸ë“¤ëŸ¬ì— ë¶„ê¸° ì¶”ê°€í•˜ê¸°

ìš”ì²­ ê²½ë¡œë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³  í‰ì†Œì— ê°œë°œí•  ë•Œ í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì‹¤ì œ ìš”ì²­ì„ ë³´ë‚´ê³  ê·¸ ì™¸ì—ëŠ” ëª©ì—…ì„ ì‚¬ìš©í•˜ì—¬ ê°œë°œí•˜ê³  ì‹¶ë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì²˜ë¦¬í•  ìˆ˜ë„ ìˆë‹¤. 
API ìš”ì²­ì„ í›… ë˜ëŠ” ë³„ë„ í•¨ìˆ˜ë¡œ ì„ ì–¸í•´ì¤€ ë‹¤ìŒ ì¡°ê±´ì— ë”°ë¼ ëª©ì—… í•¨ìˆ˜ë¥¼ ë‚´ë³´ë‚´ê±°ë‚˜ ì‹¤ì œ ìš”ì²­ í•¨ìˆ˜ë¥¼ ë‚´ë³´ë‚¼ ìˆ˜ë„ ìˆë‹¤.

```typescript
const mockFetchBrands = (): Promise<FetchBrandsResponse> =>
  new Promise((resolve) => {
    setTimeout(() => {
      resolve({
        status: "SUCCESS",
        message: null,
        data: [
          {
            id: 1,
            label: "ë°°ë¯¼ìŠ¤í† ì–´",
          },
          {
            id: 2,
            label: "ë¹„ë§ˆíŠ¸",
          },
        ],
      });
    }, 500);
  });

const fetchBrands = () => {
  if (useMock) {
    return mockFetchBrands();
  }

  return requester.get("/brands");
};

```

ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ ê°œë°œì´ ì™„ë£Œëœ í›„ì—ë„ ìœ ì§€ë³´ìˆ˜í•  ë•Œ ëª©ì—… í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ëª¨ë“  API ìš”ì²­ í•¨ìˆ˜ì— if ë¶„ê¸°ë¬¸ì„ ì¶”ê°€í•´ì•¼ í•˜ë¯€ë¡œ ë²ˆê±°ë¡­ê²Œ ëŠê»´ì§ˆ ìˆ˜ë„ ìˆë‹¤.





### axios-mock-adapterë¡œ ëª¨í‚¹í•˜ê¸°

ì„œë¹„ìŠ¤ í•¨ìˆ˜ì— ë¶„ê¸°ë¬¸ì´ ì¶”ê°€ë˜ëŠ” ê²ƒì„ ë°”ë¼ì§€ ì•ŠëŠ”ë‹¤ë©´ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤. axios-mock-adapterëŠ” Axios ìš”ì²­ì„ ê°€ë¡œì±„ì„œ ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µ ê°’ì„ ëŒ€ì‹  ë°˜í™˜í•œë‹¤.
ë¨¼ì € MockAdapter ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , í•´ë‹¹ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨í‚¹í•  ìˆ˜ ìˆë‹¤. ì•ì„  2ê°€ì§€ ë°©ë²•ê³¼ ë‹¤ë¥´ê²Œ axios-mock-adapterëŠ” Mock APIì˜ ì£¼ì†Œê°€ í•„ìš”í•˜ì§€ ì•Šë‹¤. 

```typescript
// mock/index.ts
import axios from "axios";
import MockAdapter from "axios-mock-adapter";
import fetchOrderListSuccessResponse from "fetchOrderListSuccessResponse.json";

interface MockResult {
  status?: number;
  delay?: number;
  use?: boolean;
}

const mock = new MockAdapter(axios, { onNoMatch: "passthrough" });

export const fetchOrderListMock = () =>
  mock.onGet(/\/order\/list/).reply(200, fetchOrderListSuccessResponse);

// fetchOrderListSuccessResponse.json
{
    "data": [
        {
            "orderNo": "ORDER1234", "orderDate": "2022-02-02", "shop": {
            "shopNo": "SHOP1234",
            "name": "ê°€ê²Œì´ë¦„1234" },
            "deliveryStatus": "DELIVERY"
        },
    ]
}
```

ë‹¨ìˆœíˆ ì‘ë‹µ ë°”ë””ë§Œ ëª¨í‚¹í•  ìˆ˜ ìˆì§€ë§Œ ìƒíƒœ ì½”ë“œ, ì‘ë‹µ ì§€ì—° ì‹œê°„ ë“±ì„ ì¶”ê°€ë¡œ ì„¤ì •í•  ìˆ˜ë„ ìˆë‹¤. ì´ì— ë”°ë¼ ë‹¤ì–‘í•œ HTTP ìƒíƒœ ì½”ë“œì— ëŒ€í•œ ëª©ì—…ì„ ì •ì˜í•  ìˆ˜ ìˆê³ , APIë³„ë¡œ ì§€ì—° ì‹œê°„ì„ ë‹¤ë¥´ê²Œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

ì´ë ‡ê²Œ ì‘ë‹µ ì²˜ë¦¬ë¥¼ í•˜ëŠ” ë¶€ë¶„ì„ ë³„ë„ í•¨ìˆ˜ë¡œ êµ¬í˜„í•˜ë©´ ì—¬ëŸ¬ mockí•¨ìˆ˜ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```typescript
export const lazyData = (
  status: number = Math.floor(Math.random() * 10) > 0 ? 200 : 200,
  successData: unknown = defaultSuccessData,
  failData: unknown = defaultFailData,
  time = Math.floor(Math.random() * 1000)
): Promise<any> =>
  new Promise((resolve) => {
    setTimeout(() => {
      resolve([status, status === 200 ? successData : failData]);
    }, time);
  });

export const fetchOrderListMock = ({
  status = 200,
  time = 100,
  use = true,
}: MockResult) =>
  use &&
  mock
    .onGet(/\/order\/list/)
    .reply(() =>
      lazyData(status, fetchOrderListSuccessResponse, undefined, time)
    );
```


axios-mock-adapterë¥¼ ì‚¬ìš©í•˜ë©´ GETë¿ë§Œ ì•„ë‹ˆë¼ POST, PUT, DELETE ë“± ë‹¤ë¥¸ HTTP ë©”ì„œë“œì— ëŒ€í•œ ëª©ì—…ì„ ì‘ì„±í•  ìˆ˜ ìˆê²Œ ëœë‹¤. ë˜í•œ `networkError`, `timeoutError` ë“±ì„ ë©”ì„œë“œë¡œ ì œê³µí•˜ê¸° ë•Œë¬¸ì— ë‹¤ìŒì²˜ëŸ¼ ì„ì˜ë¡œ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ë„ ìˆë‹¤.

```typescript
export const fetchOrderListMock = () => mock.onPost(/\/order\/list/).networkError();
```




### ëª©ì—… ì‚¬ìš© ì—¬ë¶€ ì œì–´í•˜ê¸°

ë¡œì»¬ì—ì„œëŠ” ëª©ì—…ì„ ì‚¬ìš©í•˜ê³  devë‚˜ ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë ¤ë©´ ê°„ë‹¨í•œ ì„¤ì •ì„ í•´ì£¼ë©´ ë˜ëŠ”ë° í”Œë˜ê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª©ì—…ìœ¼ë¡œ ê°œë°œí•  ë•Œì™€ ê°œë°œí•˜ì§€ ì•Šì„ ë•Œë¥¼ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤.

ì´ë ‡ê²Œ í•˜ë©´ í”„ë¡œë•ì…˜ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì½”ë“œì™€ ëª©ì—…ì„ ìœ„í•œ ì½”ë“œë¥¼ ë¶„ë¦¬í•  í•„ìš”ê°€ ì—†ë‹¤. ë¡œì»¬ì—ì„œ ê°œë°œí•  ë•ŒëŠ” ì£¼ë¡œ ëª©ì—…ì„ ì‚¬ìš©í•˜ê³ , dev ì„œë²„ í™˜ê²½ì´ í•„ìš”í•  ë•ŒëŠ” dev ì„œë²„ë¥¼ ë°”ë¼ë³´ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ì´ëŸ° ì‹ìœ¼ë¡œ í”„ë¡ íŠ¸ì—”ë“œì™€ ì„œë²„ë¥¼ ë…ë¦½ì‹œí‚¬ ìˆ˜ ìˆê³  í˜¹ì—¬ë‚˜ dev ì„œë²„ì— ë¬¸ì œê°€ ìƒê¸°ë”ë¼ë„ ë¡œì»¬ì—ì„œ ì§„í–‰ë˜ëŠ” í”„ë¡œíŠ¸ì—”ë“œ ê°œë°œì—ëŠ” ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ”ë‹¤.

```typescript
const useMock = Object.is(REACT_APP_MOCK, "true");

const mockFn = ({ status = 200, time = 100, use = true }: MockResult) =>
  use &&
  mock.onGet(/\/order\/list/).reply(
    () =>
      new Promise((resolve) =>
        setTimeout(() => {
          resolve([
            status,
            status === 200 ? fetchOrderListSuccessResponse : undefined,
          ]);
        }, time)
      )
  );

if (useMock) {
  mockFn({ status: 200, time: 100, use: true });
}
```

ë‹¤ìŒì²˜ëŸ¼ í”Œë˜ê·¸ì— ë”°ë¼ mockFnì„ ì œì–´í•  ìˆ˜ ìˆëŠ”ë° ë§¤ê°œë³€ìˆ˜ë¥¼ ë„˜ê²¨ íŠ¹ì • mock í•¨ìˆ˜ë§Œ ë™ì‘í•˜ê²Œ í•˜ê±°ë‚˜ ë™ì‘í•˜ì§€ ì•Šê²Œ í•  ìˆ˜ ìˆë‹¤. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì‹œ êµ¬ë¶„ ì§“ê³ ì í•œë‹¤ë©´ package.jsonì— ê´€ë ¨ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¶”ê°€í•´ì¤„ ìˆ˜ ìˆë‹¤.

```typescript
// package.json

{
  "scripts": {
    "start:mock": "REACT_APP_MOCK=true npm run start",
    "start": "REACT_APP_MOCK=false npm run start"
  }
}
```

ì´ë ‡ê²Œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œì˜ ì‹¤í–‰ ì—¬ë¶€ë¥¼ ì œì–´í•˜ì§€ ì•Šê³  config íŒŒì¼ì„ ë³„ë„ë¡œ êµ¬ì„±í•˜ê±°ë‚˜ í”„ë¡ì‹œë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆë‹¤.

axios-mock-adapterë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° API ìš”ì²­ì„ ì¤‘ê°„ì— ê°€ë¡œì±„ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ì‹¤ì œë¡œ API ìš”ì²­ì„ ì£¼ê³ ë°›ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ ë¸Œë¼ìš°ì €ê°€ ì œê³µí•˜ëŠ” ê°œë°œì ë„êµ¬ì˜ ë„¤íŠ¸ì›Œí¬ íƒ­ì—ì„œëŠ” í™•ì¸í•˜ê¸° ì–´ë µë‹¤. ë§Œì•½ API ìš”ì²­ì˜ íë¦„ì„ íŒŒì•…í•˜ê³  ì‹¶ë‹¤ë©´ react-query-devtools í˜¹ì€ redux text toolê³¼ ê°™ì´ ë³„ë„ì˜ ë„êµ¬ë¥¼ í™œìš©í•´ì•¼ í•œë‹¤.

ëª©ì—…ì„ ì‚¬ìš©í•  ë•Œ ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ í™•ì¸í•˜ê³  ì‹¶ì„ ë•ŒëŠ” ë„¤íŠ¸ì›Œí¬ì— ë³´ë‚¸ ìš”ì²­ì„ ë³€ê²½í•´ì£¼ëŠ” Cypressê°™ì€ ë„êµ¬ì˜ ì›¹í›…ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

ğŸ“¢ Cypress
í”„ë¡ íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì˜¤í”ˆ ì†ŒìŠ¤ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ë“œ íˆ¬ ì—”ë“œ í…ŒìŠ¤íŠ¸ ë„êµ¬ë‹¤. ì£¼ë¡œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë™ì‘ì„ ì‹œë®¬ë ˆì´ì…˜í•˜ê³  í…ŒìŠ¤íŠ¸í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤. CypressëŠ” ì‚¬ìš©í•˜ê¸° ì‰½ê³  ê°•ë ¥í•œ ê¸°ëŠ¥ì„ ì œê³µí•˜ì—¬ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë”ìš± ê²¬ê³ í•˜ê³  ì•ˆì •ì ìœ¼ë¡œ ê°œë°œí•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤€ë‹¤.













